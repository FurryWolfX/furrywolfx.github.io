import{_ as s,o as n,c as a,Q as l}from"./chunks/framework.a5795de3.js";const F=JSON.parse('{"title":"QT（C++）自学日记（长期更新）","description":"","frontmatter":{"title":"QT（C++）自学日记（长期更新）","catalog":true,"date":"2018-10-01T16:50:24.000Z","subtitle":null,"header-img":null,"tags":["QT","CPP"]},"headers":[],"relativePath":"docs/backend/qt-cpp-note.md","filePath":"docs/backend/qt-cpp-note.md"}'),p={name:"docs/backend/qt-cpp-note.md"},o=l(`<h1 id="qt-c-自学日记-长期更新" tabindex="-1">QT（C++）自学日记（长期更新） <a class="header-anchor" href="#qt-c-自学日记-长期更新" aria-label="Permalink to &quot;QT（C++）自学日记（长期更新）&quot;">​</a></h1><blockquote><p>起点是为了补充 Linux 下的一些轮子，而且公司有个简单的服务器 GUI 管理系统要做，所以就自学了下，反正多学点总是好的。</p></blockquote><h2 id="qstringlist-类常用方法总结" tabindex="-1">QStringList 类常用方法总结 <a class="header-anchor" href="#qstringlist-类常用方法总结" aria-label="Permalink to &quot;QStringList 类常用方法总结&quot;">​</a></h2><p>从 <code>QList&lt;QString&gt;</code> 继承而来，它提供快速索引为基础的接入以及快速插入和清除 其成员函数用于操作这个字符串列表如</p><ul><li><code>append()</code></li><li><code>insert()</code></li><li><code>replace()</code></li><li><code>removeAll()</code></li><li><code>removeAt()</code></li><li><code>removeFirst()</code></li><li><code>removeLast()</code></li><li><code>removeOne()</code></li><li>等</li></ul><h3 id="增加字符串" tabindex="-1">增加字符串 <a class="header-anchor" href="#增加字符串" aria-label="Permalink to &quot;增加字符串&quot;">​</a></h3><p>可以通过 <code>append()</code> ，或使用 <code>&lt;&lt;</code>，如</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QStringList fonts;</span></span>
<span class="line"><span style="color:#E1E4E8;">fonts </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Arial&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Helvetica&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Times&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Courier&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#6A737D;">// fonts:[ &quot;Arial&quot; ,&quot;Helvetica&quot;, &quot;Times&quot; , &quot;Courier&quot;]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QStringList fonts;</span></span>
<span class="line"><span style="color:#24292E;">fonts </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Arial&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Helvetica&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Times&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Courier&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#6A737D;">// fonts:[ &quot;Arial&quot; ,&quot;Helvetica&quot;, &quot;Times&quot; , &quot;Courier&quot;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="合并字符串使用-join" tabindex="-1">合并字符串使用 <code>join( )</code> <a class="header-anchor" href="#合并字符串使用-join" aria-label="Permalink to &quot;合并字符串使用 \`join( )\`&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QString str </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> fonts.</span><span style="color:#B392F0;">join</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;,&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// str == &quot;Arial,Helvetica,Times,Courier&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QString str </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> fonts.</span><span style="color:#6F42C1;">join</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;,&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// str == &quot;Arial,Helvetica,Times,Courier&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="拆分字符串" tabindex="-1">拆分字符串 <a class="header-anchor" href="#拆分字符串" aria-label="Permalink to &quot;拆分字符串&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QString str </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot; Arial,Helvetica, ,Times,Courier &quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">QStringList list1 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> str.</span><span style="color:#B392F0;">split</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;,&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// list1: [ &quot; Arial &quot;, &quot; Helvetica &quot;,” “, &quot; Times &quot;, &quot; Courier &quot; ]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QString str </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot; Arial,Helvetica, ,Times,Courier &quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">QStringList list1 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> str.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;,&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// list1: [ &quot; Arial &quot;, &quot; Helvetica &quot;,” “, &quot; Times &quot;, &quot; Courier &quot; ]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QStringList list2 </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> str.</span><span style="color:#B392F0;">split</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;,&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;">::SkipEmptyParts);</span></span>
<span class="line"><span style="color:#6A737D;">// list2: [ &quot; Arial &quot;, &quot; Helvetica &quot;, &quot; Times &quot;, &quot; Courier &quot; ]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QStringList list2 </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> str.</span><span style="color:#6F42C1;">split</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;,&quot;</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;">::SkipEmptyParts);</span></span>
<span class="line"><span style="color:#6A737D;">// list2: [ &quot; Arial &quot;, &quot; Helvetica &quot;, &quot; Times &quot;, &quot; Courier &quot; ]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>也就是说如果有 <code>QString：：SkipEmptyParts</code>，空项不会出现在结果。默认情况下，空项被保留</p><h3 id="索引" tabindex="-1">索引 <a class="header-anchor" href="#索引" aria-label="Permalink to &quot;索引&quot;">​</a></h3><p><code>IndexOf()</code> 函数返回给定字符串的第一个出现的索引。 而 <code>lastIndexOf()</code> 函数，返回字符串的最后一次出现的索引。</p><h3 id="替换-replaceinstrings" tabindex="-1">替换 <code>replaceInStrings()</code> <a class="header-anchor" href="#替换-replaceinstrings" aria-label="Permalink to &quot;替换 \`replaceInStrings()\`&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QStringList files;</span></span>
<span class="line"><span style="color:#E1E4E8;">files </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;$QTDIR/src/moc/moc.y&quot;</span></span>
<span class="line"><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;$QTDIR/src/moc/moc.l&quot;</span></span>
<span class="line"><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;$QTDIR/include/qconfig.h&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">files.</span><span style="color:#B392F0;">replaceInStrings</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;$QTDIR&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;/usr/lib/qt&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// files: [ &quot;/usr/lib/qt/src/moc/moc.y&quot;, ...]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QStringList files;</span></span>
<span class="line"><span style="color:#24292E;">files </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;$QTDIR/src/moc/moc.y&quot;</span></span>
<span class="line"><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;$QTDIR/src/moc/moc.l&quot;</span></span>
<span class="line"><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;$QTDIR/include/qconfig.h&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">files.</span><span style="color:#6F42C1;">replaceInStrings</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;$QTDIR&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;/usr/lib/qt&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// files: [ &quot;/usr/lib/qt/src/moc/moc.y&quot;, ...]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="过滤-filter" tabindex="-1">过滤 <code>filter()</code> <a class="header-anchor" href="#过滤-filter" aria-label="Permalink to &quot;过滤 \`filter()\`&quot;">​</a></h3><p>可以让你提取一个新的列表只包含这些字符串包含一个特定的字符串（或匹配特定正则表达式）：</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QStringList list;</span></span>
<span class="line"><span style="color:#E1E4E8;">list </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Bill Murray&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;John Doe&quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;Bill Clinton&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">QStringList result;</span></span>
<span class="line"><span style="color:#E1E4E8;">result </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> list.</span><span style="color:#B392F0;">filter</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Bill&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#6A737D;">// result: [&quot;Bill Murray&quot;, &quot;Bill Clinton&quot;]</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QStringList list;</span></span>
<span class="line"><span style="color:#24292E;">list </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Bill Murray&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;John Doe&quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;Bill Clinton&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">QStringList result;</span></span>
<span class="line"><span style="color:#24292E;">result </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> list.</span><span style="color:#6F42C1;">filter</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Bill&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#6A737D;">// result: [&quot;Bill Murray&quot;, &quot;Bill Clinton&quot;]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="遍历" tabindex="-1">遍历 <a class="header-anchor" href="#遍历" aria-label="Permalink to &quot;遍历&quot;">​</a></h3><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> (</span><span style="color:#B392F0;">QList</span><span style="color:#E1E4E8;">&lt;</span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;">&gt;::Iterator it </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> files.</span><span style="color:#B392F0;">begin</span><span style="color:#E1E4E8;">(); it </span><span style="color:#F97583;">!=</span><span style="color:#E1E4E8;"> files.</span><span style="color:#B392F0;">end</span><span style="color:#E1E4E8;">(); it</span><span style="color:#F97583;">++</span><span style="color:#E1E4E8;">){</span></span>
<span class="line"><span style="color:#E1E4E8;">    ui-&gt;listWidget-&gt;</span><span style="color:#B392F0;">addItem</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QListWidgetItem</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">it)));</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">for</span><span style="color:#24292E;"> (</span><span style="color:#6F42C1;">QList</span><span style="color:#24292E;">&lt;</span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;">&gt;::Iterator it </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> files.</span><span style="color:#6F42C1;">begin</span><span style="color:#24292E;">(); it </span><span style="color:#D73A49;">!=</span><span style="color:#24292E;"> files.</span><span style="color:#6F42C1;">end</span><span style="color:#24292E;">(); it</span><span style="color:#D73A49;">++</span><span style="color:#24292E;">){</span></span>
<span class="line"><span style="color:#24292E;">    ui-&gt;listWidget-&gt;</span><span style="color:#6F42C1;">addItem</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QListWidgetItem</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">*</span><span style="color:#24292E;">it)));</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="利用-qregexp-移除字符串中所有空格" tabindex="-1">利用 QRegExp 移除字符串中所有空格 <a class="header-anchor" href="#利用-qregexp-移除字符串中所有空格" aria-label="Permalink to &quot;利用 QRegExp 移除字符串中所有空格&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QStringUtil</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">removeAllSpaces</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">str</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> str.</span><span style="color:#B392F0;">remove</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QRegExp</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;</span><span style="color:#79B8FF;">\\\\</span><span style="color:#9ECBFF;">s&quot;</span><span style="color:#E1E4E8;">));</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">QString</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QStringUtil</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">removeAllSpaces</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;"> </span><span style="color:#E36209;">str</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> str.</span><span style="color:#6F42C1;">remove</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QRegExp</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;</span><span style="color:#005CC5;">\\\\</span><span style="color:#032F62;">s&quot;</span><span style="color:#24292E;">));</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="qinputdialog-的使用" tabindex="-1">QInputDialog 的使用 <a class="header-anchor" href="#qinputdialog-的使用" aria-label="Permalink to &quot;QInputDialog 的使用&quot;">​</a></h2><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> ok;</span></span>
<span class="line"><span style="color:#E1E4E8;">QString text </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QInputDialog</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">getText</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;对话框&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#9ECBFF;">&quot;请输入文件名&quot;</span><span style="color:#E1E4E8;"> , </span><span style="color:#B392F0;">QLineEdit</span><span style="color:#E1E4E8;">::Normal, </span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">ok);</span></span>
<span class="line"><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (ok) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">qDebug</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> text;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> ok;</span></span>
<span class="line"><span style="color:#24292E;">QString text </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QInputDialog</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">getText</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">this</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;对话框&quot;</span><span style="color:#24292E;">, </span><span style="color:#032F62;">&quot;请输入文件名&quot;</span><span style="color:#24292E;"> , </span><span style="color:#6F42C1;">QLineEdit</span><span style="color:#24292E;">::Normal, </span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">ok);</span></span>
<span class="line"><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (ok) {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">qDebug</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> text;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>参数 <code>QWidget *parent</code>：熟悉的父组件的指针；</p><p>参数 <code>const QString &amp;title</code>：对话框的标题；</p><p>参数 <code>const QString &amp;label</code>：在输入框上面的提示语句；</p><p>参数 <code>QLineEdit::EchoMode echo</code>：指明这个 QLineEdit 的输入模式，取值范围是<code>QLineEdit::EchoMode</code>，默认是 Normal，也就是正常显示，你也可以声明为 Password，这样就是密码的输入显示了，具体请查阅 API；</p><p>参数 <code>const QString &amp;text</code>：QLineEdit 的默认字符串；</p><p>参数 <code>bool *ok</code>：ok 是可选的，如果非 NULL，则当用户按下对话框的 OK 按钮时，这个 bool 变量会被置为 true，可以由这个去判断用户是按下的 OK 还是 Cancel，从而获知这个 text 是不是有意义；</p><p>参数 <code>Qt::WindowFlags flags</code>：flags 用于指定对话框的样式。</p><p>虽然参数很多，但是每个参数的含义都比较明显，大家只要参照 API 就可以知道了。</p><p>函数的返回值是 QString，也就是用户在 QLineEdit 里面输入的内容。至于这个内容有没有意义，那就要看那个 ok 参数是不是 true 了。</p><h2 id="利用-qprocess-调用系统命令" tabindex="-1">利用 QProcess 调用系统命令 <a class="header-anchor" href="#利用-qprocess-调用系统命令" aria-label="Permalink to &quot;利用 QProcess 调用系统命令&quot;">​</a></h2><p>例如 Linux 下调用赋予文件执行权限：</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QProcess </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">cmd </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> QProcess;</span></span>
<span class="line"><span style="color:#E1E4E8;">cmd-&gt;</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;chmod +x &quot;</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> basePath </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> fileName);</span><span style="color:#6A737D;"> // 赋予执行权限</span></span>
<span class="line"><span style="color:#E1E4E8;">cmd-&gt;</span><span style="color:#B392F0;">waitForFinished</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#F97583;">delete</span><span style="color:#E1E4E8;"> cmd;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QProcess </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">cmd </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> QProcess;</span></span>
<span class="line"><span style="color:#24292E;">cmd-&gt;</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;chmod +x &quot;</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> basePath </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> fileName);</span><span style="color:#6A737D;"> // 赋予执行权限</span></span>
<span class="line"><span style="color:#24292E;">cmd-&gt;</span><span style="color:#6F42C1;">waitForFinished</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#D73A49;">delete</span><span style="color:#24292E;"> cmd;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">CmdUtil</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">runCmd</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">cmdStr</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">timeout</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">    QProcess cmd;</span></span>
<span class="line"><span style="color:#E1E4E8;">    cmd.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;cmd.exe&quot;</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">QStringList</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">&quot;/c&quot;</span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;">cmdStr);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> (cmd.</span><span style="color:#B392F0;">waitForStarted</span><span style="color:#E1E4E8;">()) {</span></span>
<span class="line"><span style="color:#E1E4E8;">        cmd.</span><span style="color:#B392F0;">waitForFinished</span><span style="color:#E1E4E8;">(timeout);</span></span>
<span class="line"><span style="color:#E1E4E8;">        QString strTemp </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">fromLocal8Bit</span><span style="color:#E1E4E8;">(cmd.</span><span style="color:#B392F0;">readAllStandardOutput</span><span style="color:#E1E4E8;">());</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> strTemp;</span></span>
<span class="line"><span style="color:#E1E4E8;">    } </span><span style="color:#F97583;">else</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">qDebug</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;cmd error&quot;</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;&quot;</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">QString</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">CmdUtil</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">runCmd</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;"> </span><span style="color:#E36209;">cmdStr</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#E36209;">timeout</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">    QProcess cmd;</span></span>
<span class="line"><span style="color:#24292E;">    cmd.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;cmd.exe&quot;</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">QStringList</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">&quot;/c&quot;</span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;">cmdStr);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> (cmd.</span><span style="color:#6F42C1;">waitForStarted</span><span style="color:#24292E;">()) {</span></span>
<span class="line"><span style="color:#24292E;">        cmd.</span><span style="color:#6F42C1;">waitForFinished</span><span style="color:#24292E;">(timeout);</span></span>
<span class="line"><span style="color:#24292E;">        QString strTemp </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">fromLocal8Bit</span><span style="color:#24292E;">(cmd.</span><span style="color:#6F42C1;">readAllStandardOutput</span><span style="color:#24292E;">());</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> strTemp;</span></span>
<span class="line"><span style="color:#24292E;">    } </span><span style="color:#D73A49;">else</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">qDebug</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;cmd error&quot;</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;&quot;</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="qtimer-运行定时器线程" tabindex="-1">QTimer 运行定时器线程 <a class="header-anchor" href="#qtimer-运行定时器线程" aria-label="Permalink to &quot;QTimer 运行定时器线程&quot;">​</a></h2><p>头文件定义如下</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#ifndef</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MAINWINDOW_H</span></span>
<span class="line"><span style="color:#F97583;">#define</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MAINWINDOW_H</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;QMainWindow&gt;</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;QFile&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">namespace</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ui</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MainWindow</span><span style="color:#E1E4E8;">;</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MainWindow</span><span style="color:#E1E4E8;"> : </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QMainWindow</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    Q_OBJECT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">public:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">explicit</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">MainWindow</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QWidget</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">parent</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">0</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> tomcatPort;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">static</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> mysqlPort;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">~MainWindow</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">private:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">Ui</span><span style="color:#E1E4E8;">::MainWindow </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">ui;</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">initConfig</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QFile</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&amp;</span><span style="color:#FFAB70;">config</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">private slots:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">onTomcatCheckReceive</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">flag</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">onMysqlCheckReceive</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">flag</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">onLogRead</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">QString</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">str</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_tomcatStart_clicked</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_tomcatStop_clicked</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_mysqlStart_clicked</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">on_mysqlStop_clicked</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F97583;">#endif</span><span style="color:#6A737D;"> // MAINWINDOW_H</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#ifndef</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MAINWINDOW_H</span></span>
<span class="line"><span style="color:#D73A49;">#define</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MAINWINDOW_H</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;QMainWindow&gt;</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;QFile&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">namespace</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ui</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MainWindow</span><span style="color:#24292E;">;</span></span>
<span class="line"><span style="color:#24292E;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MainWindow</span><span style="color:#24292E;"> : </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QMainWindow</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    Q_OBJECT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">public:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">explicit</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">MainWindow</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QWidget</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#E36209;">parent</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">=</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">0</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> tomcatPort;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">static</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> mysqlPort;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">~MainWindow</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">private:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">Ui</span><span style="color:#24292E;">::MainWindow </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">ui;</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">initConfig</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QFile</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&amp;</span><span style="color:#E36209;">config</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">private slots:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onTomcatCheckReceive</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> </span><span style="color:#E36209;">flag</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onMysqlCheckReceive</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">bool</span><span style="color:#24292E;"> </span><span style="color:#E36209;">flag</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onLogRead</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">QString</span><span style="color:#24292E;"> </span><span style="color:#E36209;">str</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_tomcatStart_clicked</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_tomcatStop_clicked</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_mysqlStart_clicked</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">on_mysqlStop_clicked</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49;">#endif</span><span style="color:#6A737D;"> // MAINWINDOW_H</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>源码文件：</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">QTimer timer;</span></span>
<span class="line"><span style="color:#B392F0;">MainWindow</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">MainWindow</span><span style="color:#E1E4E8;">(QWidget </span><span style="color:#F97583;">*</span><span style="color:#E1E4E8;">parent) :</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">QMainWindow</span><span style="color:#E1E4E8;">(parent),</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">ui</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Ui</span><span style="color:#E1E4E8;">::MainWindow)</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#6A737D;">        // 无关代码略</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">QObject</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">connect</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">timer, </span><span style="color:#B392F0;">SIGNAL</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">timeout</span><span style="color:#E1E4E8;">()), </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">tomcatCheckWorker, </span><span style="color:#B392F0;">SLOT</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">onTimeout</span><span style="color:#E1E4E8;">()));</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">QObject</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">connect</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">tomcatCheckWorker, </span><span style="color:#B392F0;">SIGNAL</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">finish</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;">)), </span><span style="color:#79B8FF;">this</span><span style="color:#E1E4E8;">, </span><span style="color:#B392F0;">SLOT</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">onTomcatCheckReceive</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">bool</span><span style="color:#E1E4E8;">)));</span></span>
<span class="line"><span style="color:#E1E4E8;">        timer.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">500</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">QTimer timer;</span></span>
<span class="line"><span style="color:#6F42C1;">MainWindow</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">MainWindow</span><span style="color:#24292E;">(QWidget </span><span style="color:#D73A49;">*</span><span style="color:#24292E;">parent) :</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">QMainWindow</span><span style="color:#24292E;">(parent),</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">ui</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Ui</span><span style="color:#24292E;">::MainWindow)</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#6A737D;">        // 无关代码略</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">QObject</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">connect</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">timer, </span><span style="color:#6F42C1;">SIGNAL</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">timeout</span><span style="color:#24292E;">()), </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">tomcatCheckWorker, </span><span style="color:#6F42C1;">SLOT</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">onTimeout</span><span style="color:#24292E;">()));</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">QObject</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">connect</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">tomcatCheckWorker, </span><span style="color:#6F42C1;">SIGNAL</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">finish</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">bool</span><span style="color:#24292E;">)), </span><span style="color:#005CC5;">this</span><span style="color:#24292E;">, </span><span style="color:#6F42C1;">SLOT</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">onTomcatCheckReceive</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">bool</span><span style="color:#24292E;">)));</span></span>
<span class="line"><span style="color:#24292E;">        timer.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">500</span><span style="color:#24292E;">);</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="qt-中的线程-qthread" tabindex="-1">QT 中的线程 QThread <a class="header-anchor" href="#qt-中的线程-qthread" aria-label="Permalink to &quot;QT 中的线程 QThread&quot;">​</a></h2><p>这里只记录 QT5 中推荐的方式：</p><div class="language-cpp vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">cpp</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&lt;QtCore&gt;</span></span>
<span class="line"><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">Worker</span><span style="color:#E1E4E8;"> : </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">QObject</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    Q_OBJECT</span></span>
<span class="line"><span style="color:#E1E4E8;">private slots:</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">void</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">onTimeout</span><span style="color:#E1E4E8;">()</span></span>
<span class="line"><span style="color:#E1E4E8;">    {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#B392F0;">qDebug</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">&quot;Worker::onTimeout get called from?: &quot;</span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#B392F0;">QThread</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">currentThreadId</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">};</span></span>
<span class="line"><span style="color:#F97583;">#include</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;main.moc&quot;</span></span>
<span class="line"><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">main</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">int</span><span style="color:#E1E4E8;"> </span><span style="color:#FFAB70;">argc</span><span style="color:#E1E4E8;">, </span><span style="color:#F97583;">char</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">*</span><span style="color:#FFAB70;">argv</span><span style="color:#E1E4E8;">[])</span></span>
<span class="line"><span style="color:#E1E4E8;">{</span></span>
<span class="line"><span style="color:#E1E4E8;">    QCoreApplication </span><span style="color:#B392F0;">a</span><span style="color:#E1E4E8;">(argc, argv);</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">qDebug</span><span style="color:#E1E4E8;">()</span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#9ECBFF;">&quot;From main thread: &quot;</span><span style="color:#F97583;">&lt;&lt;</span><span style="color:#B392F0;">QThread</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">currentThreadId</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    QThread t;</span></span>
<span class="line"><span style="color:#E1E4E8;">    QTimer timer;</span></span>
<span class="line"><span style="color:#E1E4E8;">    Worker worker;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">QObject</span><span style="color:#E1E4E8;">::</span><span style="color:#B392F0;">connect</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">timer, </span><span style="color:#B392F0;">SIGNAL</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">timeout</span><span style="color:#E1E4E8;">()), </span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">worker, </span><span style="color:#B392F0;">SLOT</span><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">onTimeout</span><span style="color:#E1E4E8;">()));</span></span>
<span class="line"><span style="color:#E1E4E8;">    timer.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">(</span><span style="color:#79B8FF;">1000</span><span style="color:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    worker.</span><span style="color:#B392F0;">moveToThread</span><span style="color:#E1E4E8;">(</span><span style="color:#F97583;">&amp;</span><span style="color:#E1E4E8;">t);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    t.</span><span style="color:#B392F0;">start</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> a.</span><span style="color:#B392F0;">exec</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&lt;QtCore&gt;</span></span>
<span class="line"><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">Worker</span><span style="color:#24292E;"> : </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">QObject</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    Q_OBJECT</span></span>
<span class="line"><span style="color:#24292E;">private slots:</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">void</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">onTimeout</span><span style="color:#24292E;">()</span></span>
<span class="line"><span style="color:#24292E;">    {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#6F42C1;">qDebug</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">&quot;Worker::onTimeout get called from?: &quot;</span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#6F42C1;">QThread</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">currentThreadId</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">};</span></span>
<span class="line"><span style="color:#D73A49;">#include</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;main.moc&quot;</span></span>
<span class="line"><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">main</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">int</span><span style="color:#24292E;"> </span><span style="color:#E36209;">argc</span><span style="color:#24292E;">, </span><span style="color:#D73A49;">char</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">*</span><span style="color:#E36209;">argv</span><span style="color:#24292E;">[])</span></span>
<span class="line"><span style="color:#24292E;">{</span></span>
<span class="line"><span style="color:#24292E;">    QCoreApplication </span><span style="color:#6F42C1;">a</span><span style="color:#24292E;">(argc, argv);</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">qDebug</span><span style="color:#24292E;">()</span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#032F62;">&quot;From main thread: &quot;</span><span style="color:#D73A49;">&lt;&lt;</span><span style="color:#6F42C1;">QThread</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">currentThreadId</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    QThread t;</span></span>
<span class="line"><span style="color:#24292E;">    QTimer timer;</span></span>
<span class="line"><span style="color:#24292E;">    Worker worker;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">QObject</span><span style="color:#24292E;">::</span><span style="color:#6F42C1;">connect</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">timer, </span><span style="color:#6F42C1;">SIGNAL</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">timeout</span><span style="color:#24292E;">()), </span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">worker, </span><span style="color:#6F42C1;">SLOT</span><span style="color:#24292E;">(</span><span style="color:#6F42C1;">onTimeout</span><span style="color:#24292E;">()));</span></span>
<span class="line"><span style="color:#24292E;">    timer.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">(</span><span style="color:#005CC5;">1000</span><span style="color:#24292E;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    worker.</span><span style="color:#6F42C1;">moveToThread</span><span style="color:#24292E;">(</span><span style="color:#D73A49;">&amp;</span><span style="color:#24292E;">t);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    t.</span><span style="color:#6F42C1;">start</span><span style="color:#24292E;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> a.</span><span style="color:#6F42C1;">exec</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div>`,48),e=[o];function t(c,r,E,i,y,u){return n(),a("div",null,e)}const b=s(p,[["render",t]]);export{F as __pageData,b as default};
