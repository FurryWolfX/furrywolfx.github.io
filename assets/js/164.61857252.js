(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{416:function(s,a,t){"use strict";t.r(a);var n=t(5),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"增量备份的方式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#增量备份的方式"}},[s._v("#")]),s._v(" 增量备份的方式")]),s._v(" "),t("p",[s._v("利用 "),t("code",[s._v("tar -g")]),s._v(" 参数，在第一次备份时候生成时间戳文件，里面包含指定备份目录下的所有文件的一个时间戳，下次增量备份，tar 会利用时间戳文件去比较，只有那些内容在这段时间有修改的文件，才会被打包。")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 先执行完整备份")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /backup\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -g snapshot -zcpPf backup-full.tar.gz "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/proc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/mnt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/lost+found "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/sys "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/media "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup /\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 差量备份")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /backup\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -g snapshot -zcpPf backup-incremental_1.tar.gz "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/proc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/mnt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/lost+found "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/sys "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/media "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup /\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h1",{attrs:{id:"定义成脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#定义成脚本"}},[s._v("#")]),s._v(" 定义成脚本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DATE")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%Y%m%d%H%M%S"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /backup\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -g snapshot -zcpPf backup-incremental_"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$DATE")]),s._v(".tar.gz "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/proc "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/mnt "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/lost+found "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/sys "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/media "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--exclude"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/backup /\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h1",{attrs:{id:"还原"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#还原"}},[s._v("#")]),s._v(" 还原")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzPf backup-full.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" xzPf backup-incremental_1.tar.gz\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir proc")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mdkir lost+found")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir mnt")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir sys")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir media")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir run")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])])])}),[],!1,null,null,null);a.default=e.exports}}]);