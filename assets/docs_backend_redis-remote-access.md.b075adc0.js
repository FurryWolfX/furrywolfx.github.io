import{_ as s,o as n,c as e,Q as a}from"./chunks/framework.a1e87edc.js";const E=JSON.parse('{"title":"Redis 开启远程访问","description":"","frontmatter":{"title":"Redis 开启远程访问","catalog":true,"date":"2018-01-24T16:50:24.000Z","subtitle":null,"header-img":null,"tags":["Redis"]},"headers":[],"relativePath":"docs/backend/redis-remote-access.md","filePath":"docs/backend/redis-remote-access.md"}'),o={name:"docs/backend/redis-remote-access.md"},l=a(`<h1 id="redis-开启远程访问" tabindex="-1">Redis 开启远程访问 <a class="header-anchor" href="#redis-开启远程访问" aria-label="Permalink to &quot;Redis 开启远程访问&quot;">​</a></h1><p><code>Redis</code> 默认只允许本地访问，要使 <code>Redis</code> 可以远程访问可以修改 <code>/etc/redis/redis.conf</code></p><p>打开 <code>redis.conf</code> 文件在 <code>NETWORK</code> 部分有说明</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">################################### NETWORK #####################################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## By default, if no &quot;bind&quot; configuration directive is specified, Redis listens</span></span>
<span class="line"><span style="color:#6A737D;">## for connections from all the network interfaces available on the server.</span></span>
<span class="line"><span style="color:#6A737D;">## It is possible to listen to just one or multiple selected interfaces using</span></span>
<span class="line"><span style="color:#6A737D;">## the &quot;bind&quot; configuration directive, followed by one or more IP addresses.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## Examples:</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## bind 192.168.1.100 10.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">## bind 127.0.0.1 ::1</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the</span></span>
<span class="line"><span style="color:#6A737D;">## internet, binding to all the interfaces is dangerous and will expose the</span></span>
<span class="line"><span style="color:#6A737D;">## instance to everybody on the internet. So by default we uncomment the</span></span>
<span class="line"><span style="color:#6A737D;">## following bind directive, that will force Redis to listen only into</span></span>
<span class="line"><span style="color:#6A737D;">## the IPv4 lookback interface address (this means Redis will be able to</span></span>
<span class="line"><span style="color:#6A737D;">## accept connections only from clients running into the same computer it</span></span>
<span class="line"><span style="color:#6A737D;">## is running).</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES</span></span>
<span class="line"><span style="color:#6A737D;">## JUST COMMENT THE FOLLOWING LINE.</span></span>
<span class="line"><span style="color:#6A737D;">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span class="line"><span style="color:#B392F0;">bind</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">127.0</span><span style="color:#9ECBFF;">.0.1</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">################################### NETWORK #####################################</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## By default, if no &quot;bind&quot; configuration directive is specified, Redis listens</span></span>
<span class="line"><span style="color:#6A737D;">## for connections from all the network interfaces available on the server.</span></span>
<span class="line"><span style="color:#6A737D;">## It is possible to listen to just one or multiple selected interfaces using</span></span>
<span class="line"><span style="color:#6A737D;">## the &quot;bind&quot; configuration directive, followed by one or more IP addresses.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## Examples:</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## bind 192.168.1.100 10.0.0.1</span></span>
<span class="line"><span style="color:#6A737D;">## bind 127.0.0.1 ::1</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## ~~~ WARNING ~~~ If the computer running Redis is directly exposed to the</span></span>
<span class="line"><span style="color:#6A737D;">## internet, binding to all the interfaces is dangerous and will expose the</span></span>
<span class="line"><span style="color:#6A737D;">## instance to everybody on the internet. So by default we uncomment the</span></span>
<span class="line"><span style="color:#6A737D;">## following bind directive, that will force Redis to listen only into</span></span>
<span class="line"><span style="color:#6A737D;">## the IPv4 lookback interface address (this means Redis will be able to</span></span>
<span class="line"><span style="color:#6A737D;">## accept connections only from clients running into the same computer it</span></span>
<span class="line"><span style="color:#6A737D;">## is running).</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## IF YOU ARE SURE YOU WANT YOUR INSTANCE TO LISTEN TO ALL THE INTERFACES</span></span>
<span class="line"><span style="color:#6A737D;">## JUST COMMENT THE FOLLOWING LINE.</span></span>
<span class="line"><span style="color:#6A737D;">## ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~</span></span>
<span class="line"><span style="color:#6F42C1;">bind</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">127.0</span><span style="color:#032F62;">.0.1</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><p>解决办法：注释掉 <code>bind 127.0.0.1</code> 可以使所有的 <code>ip</code> 访问 <code>redis</code> 若是想指定多个 <code>ip</code> 访问，但并不是全部的 <code>ip</code> 访问，可以 <code>bind</code></p><p>注意 下面还有个说明</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#6A737D;">## Protected mode is a layer of security protection, in order to avoid that</span></span>
<span class="line"><span style="color:#6A737D;">## Redis instances left open on the internet are accessed and exploited.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## When protected mode is on and if:</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## 1) The server is not binding explicitly to a set of addresses using the</span></span>
<span class="line"><span style="color:#6A737D;">##    &quot;bind&quot; directive.</span></span>
<span class="line"><span style="color:#6A737D;">## 2) No password is configured.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## The server only accepts connections from clients connecting from the</span></span>
<span class="line"><span style="color:#6A737D;">## IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain</span></span>
<span class="line"><span style="color:#6A737D;">## sockets.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## By default protected mode is enabled. You should disable it only if</span></span>
<span class="line"><span style="color:#6A737D;">## you are sure you want clients from other hosts to connect to Redis</span></span>
<span class="line"><span style="color:#6A737D;">## even if no authentication is configured, nor a specific set of interfaces</span></span>
<span class="line"><span style="color:#6A737D;">## are explicitly listed using the &quot;bind&quot; directive.</span></span>
<span class="line"><span style="color:#B392F0;">protected-mode</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yes</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6A737D;">## Protected mode is a layer of security protection, in order to avoid that</span></span>
<span class="line"><span style="color:#6A737D;">## Redis instances left open on the internet are accessed and exploited.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## When protected mode is on and if:</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## 1) The server is not binding explicitly to a set of addresses using the</span></span>
<span class="line"><span style="color:#6A737D;">##    &quot;bind&quot; directive.</span></span>
<span class="line"><span style="color:#6A737D;">## 2) No password is configured.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## The server only accepts connections from clients connecting from the</span></span>
<span class="line"><span style="color:#6A737D;">## IPv4 and IPv6 loopback addresses 127.0.0.1 and ::1, and from Unix domain</span></span>
<span class="line"><span style="color:#6A737D;">## sockets.</span></span>
<span class="line"><span style="color:#6A737D;">#</span></span>
<span class="line"><span style="color:#6A737D;">## By default protected mode is enabled. You should disable it only if</span></span>
<span class="line"><span style="color:#6A737D;">## you are sure you want clients from other hosts to connect to Redis</span></span>
<span class="line"><span style="color:#6A737D;">## even if no authentication is configured, nor a specific set of interfaces</span></span>
<span class="line"><span style="color:#6A737D;">## are explicitly listed using the &quot;bind&quot; directive.</span></span>
<span class="line"><span style="color:#6F42C1;">protected-mode</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yes</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>在 redis3.2 之后，redis 增加了 <code>protected-mode</code>，在这个模式下，即使注释掉了 <code>bind 127.0.0.1</code>，再访问 redisd 时候还是报错，如下</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">(</span><span style="color:#B392F0;">error</span><span style="color:#E1E4E8;">) DENIED Redis is running </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the loopback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command </span><span style="color:#9ECBFF;">&#39;CONFIG SET protected-mode no&#39;</span><span style="color:#E1E4E8;"> from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet </span><span style="color:#F97583;">if</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">you</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">do</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">so.</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Use</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">CONFIG</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">REWRITE</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">make</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">this</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">change</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">permanent.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">2</span><span style="color:#E1E4E8;">) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to </span><span style="color:#9ECBFF;">&#39;no&#39;</span><span style="color:#E1E4E8;">, and </span><span style="color:#F97583;">then</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">restarting</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">the</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">server.</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">3</span><span style="color:#E1E4E8;">) If you started the server manually just </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> testing, restart it with the </span><span style="color:#9ECBFF;">&#39;--protected-mode no&#39;</span><span style="color:#E1E4E8;"> option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things </span><span style="color:#F97583;">in</span><span style="color:#E1E4E8;"> order </span><span style="color:#F97583;">for</span><span style="color:#E1E4E8;"> the server to start accepting connections from the outside.</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">(</span><span style="color:#6F42C1;">error</span><span style="color:#24292E;">) DENIED Redis is running </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> protected mode because protected mode is enabled, no bind address was specified, no authentication password is requested to clients. In this mode connections are only accepted from the loopback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command </span><span style="color:#032F62;">&#39;CONFIG SET protected-mode no&#39;</span><span style="color:#24292E;"> from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet </span><span style="color:#D73A49;">if</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">you</span><span style="color:#24292E;"> </span><span style="color:#032F62;">do</span><span style="color:#24292E;"> </span><span style="color:#032F62;">so.</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Use</span><span style="color:#24292E;"> </span><span style="color:#032F62;">CONFIG</span><span style="color:#24292E;"> </span><span style="color:#032F62;">REWRITE</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">make</span><span style="color:#24292E;"> </span><span style="color:#032F62;">this</span><span style="color:#24292E;"> </span><span style="color:#032F62;">change</span><span style="color:#24292E;"> </span><span style="color:#032F62;">permanent.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">2</span><span style="color:#24292E;">) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to </span><span style="color:#032F62;">&#39;no&#39;</span><span style="color:#24292E;">, and </span><span style="color:#D73A49;">then</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">restarting</span><span style="color:#24292E;"> </span><span style="color:#032F62;">the</span><span style="color:#24292E;"> </span><span style="color:#032F62;">server.</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">3</span><span style="color:#24292E;">) If you started the server manually just </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> testing, restart it with the </span><span style="color:#032F62;">&#39;--protected-mode no&#39;</span><span style="color:#24292E;"> option. 4) Setup a bind address or an authentication password. NOTE: You only need to do one of the above things </span><span style="color:#D73A49;">in</span><span style="color:#24292E;"> order </span><span style="color:#D73A49;">for</span><span style="color:#24292E;"> the server to start accepting connections from the outside.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>修改办法：<code>protected-mode no</code></p>`,10),p=[l];function t(c,r,i,d,y,u){return n(),e("div",null,p)}const m=s(o,[["render",t]]);export{E as __pageData,m as default};
