import{_ as s,o as n,c as a,V as l}from"./chunks/framework.4acca30d.js";const A=JSON.parse('{"title":"Android 问题笔记【持续更新】","description":"","frontmatter":{"title":"Android 问题笔记【持续更新】","catalog":true,"date":"2019-05-24T11:32:00.000Z","subtitle":null,"header-img":null,"tags":["Linux","Android","Cordova"]},"headers":[],"relativePath":"docs/frontend/hybird/android-q-note.md","filePath":"docs/frontend/hybird/android-q-note.md"}'),p={name:"docs/frontend/hybird/android-q-note.md"},o=l(`<h1 id="android-问题笔记【持续更新】" tabindex="-1">Android 问题笔记【持续更新】 <a class="header-anchor" href="#android-问题笔记【持续更新】" aria-label="Permalink to &quot;Android 问题笔记【持续更新】&quot;">​</a></h1><h2 id="dev-kvm-设备权限被拒绝的问题" tabindex="-1">/dev/kvm 设备权限被拒绝的问题 <a class="header-anchor" href="#dev-kvm-设备权限被拒绝的问题" aria-label="Permalink to &quot;/dev/kvm 设备权限被拒绝的问题&quot;">​</a></h2><p>在使用 AndroidStudio 时出现 <code>/dev/kvm</code> 设备权限被拒绝的问题，解决方案如下：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">sudo</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">chown</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">wolfx</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">/dev/kvm</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>wolfx 是我当前的登录名</p><h2 id="android-studio-报错显示-mips64el-linux-android-strip-找不到" tabindex="-1">Android Studio 报错显示 mips64el-linux-android-strip 找不到 <a class="header-anchor" href="#android-studio-报错显示-mips64el-linux-android-strip-找不到" aria-label="Permalink to &quot;Android Studio 报错显示 mips64el-linux-android-strip 找不到&quot;">​</a></h2><p>如果 ndk 版本在 r17 版, 很有可能出现这个问题. 我的解决方案是:</p><ul><li>先清除 <code>Android/Sdk/ndk-bundle/</code> 下的内容</li><li>从 <a href="https://developer.android.google.cn/ndk/downloads/older_releases" target="_blank" rel="noreferrer">https://developer.android.google.cn/ndk/downloads/older_releases</a> 下载 16b 版本的 ndk 到本地, 并解压说, 将解压缩后的所有文件拷贝到 Android/Sdk/ndk-bundle/ 目录下</li><li>重新 build 工程</li></ul><h2 id="android-默认签名与签名的-sha-1" tabindex="-1">Android 默认签名与签名的 SHA-1 <a class="header-anchor" href="#android-默认签名与签名的-sha-1" aria-label="Permalink to &quot;Android 默认签名与签名的 SHA-1&quot;">​</a></h2><p>在使用第三方服务时，经常会用到 <code>KeyStore SHA-1</code> 这里记录下获取方式。</p><h2 id="默认-keystore-存储路径" tabindex="-1">默认 KeyStore 存储路径 <a class="header-anchor" href="#默认-keystore-存储路径" aria-label="Permalink to &quot;默认 KeyStore 存储路径&quot;">​</a></h2><p>在 <code>Mac/Linux</code> 系统中，<code>debug.keystore</code> 文件默认储存在 <code>~/.android/</code> 路径下。</p><p>在 <code>Windows</code> 系统中，<code>debug.keystore</code> 文件将默认存储在 <code>C:\\Users\\{USERNAME}\\.android\\</code> 路径下。</p><h2 id="获取默认-keystore-sha-1" tabindex="-1">获取默认 KeyStore SHA-1 <a class="header-anchor" href="#获取默认-keystore-sha-1" aria-label="Permalink to &quot;获取默认 KeyStore SHA-1&quot;">​</a></h2><p>输入下面命令查看指纹信息：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">keytool</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-list</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-v</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-keystore</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">~/.android/debug.keystore</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-alias</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">androiddebugkey</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-storepass</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">android</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-keypass</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">android</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="新版-android-兼容处理" tabindex="-1">新版 android 兼容处理 <a class="header-anchor" href="#新版-android-兼容处理" aria-label="Permalink to &quot;新版 android 兼容处理&quot;">​</a></h2><h3 id="文件路径问题" tabindex="-1">文件路径问题 <a class="header-anchor" href="#文件路径问题" aria-label="Permalink to &quot;文件路径问题&quot;">​</a></h3><p>通过 <code>Uri.fromFile(file);</code> 获取的 <code>file://</code> 开头的路径，在新 android 上无权限使用。</p><p>解决方案是用 <code>FileProvider</code> 获得 <code>content://</code> 开头的路径。</p><p>首先在 manifest 中配置：</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">application</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">provider</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">android.support.v4.content.FileProvider</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">authorities</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.junl.fileprovider</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">exported</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">false</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">      </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">grantUriPermissions</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">true</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">meta-data</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">android.support.FILE_PROVIDER_PATHS</span><span style="color:#89DDFF;">&quot;</span></span>
<span class="line"><span style="color:#89DDFF;">          </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">resource</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">@xml/file_paths</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> /&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">provider</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">application</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>在 <code>res/xml/file_paths.xml</code> 中添加</p><div class="language-xml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">xml</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#89DDFF;">&lt;?</span><span style="color:#F07178;">xml</span><span style="color:#C792EA;"> version</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">1.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C792EA;"> encoding</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">utf-8</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">?&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">paths</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">xmlns</span><span style="color:#89DDFF;">:</span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">http://schemas.android.com/apk/res/android</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">external-path</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">name</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">external_files</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">path</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">.</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">/&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">paths</span><span style="color:#89DDFF;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>编写 Java 代码如下：</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">junl</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">cordova</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Context</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">net</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Uri</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">os</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Build</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">support</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">v4</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">FileProvider</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">io</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">File</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Utils</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Uri</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getUriFromFile</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Context</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">File</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">file</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">VERSION</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SDK_INT </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#A6ACCD;"> Build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">VERSION_CODES</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">N</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">// 兼容 7.0</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> FileProvider</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getUriForFile</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.junl.fileprovider</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> file</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> Uri</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">fromFile</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">file</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h3 id="权限问题" tabindex="-1">权限问题 <a class="header-anchor" href="#权限问题" aria-label="Permalink to &quot;权限问题&quot;">​</a></h3><p>新 android 的权限不仅仅要在 manifest 中申明，也需要在代码中授权：</p><p>写了个工具类如下：</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">junl</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">cordova</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Manifest</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">content</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">pm</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">PackageManager</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">os</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Build</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">cordova</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">CordovaActivity</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">PermissionUtil</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> PERMISSIONS_REQUEST </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> PERMISSION_GRANTED </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> PackageManager</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">PERMISSION_GRANTED</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">final</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> Permission </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]{</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ACCESS_COARSE_LOCATION</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于进行网络定位</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ACCESS_FINE_LOCATION</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于访问GPS定位</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ACCESS_LOCATION_EXTRA_COMMANDS</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于访问A-GPS定位</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ACCESS_NETWORK_STATE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于获取运营商信息，用于支持提供运营商信息相关的接口</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">ACCESS_WIFI_STATE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于访问wifi网络信息，wifi信息会用于进行网络定位</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">CHANGE_WIFI_STATE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于获取wifi的获取权限，wifi信息会用来进行网络定位</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">INTERNET</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于访问网络，网络定位需要上网</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">READ_PHONE_STATE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于读取手机当前的状态</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">WRITE_EXTERNAL_STORAGE</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#676E95;font-style:italic;">// 用于写入缓存数据到扩展存储卡</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">READ_EXTERNAL_STORAGE</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BLUETOOTH</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">BLUETOOTH_ADMIN</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">            Manifest</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">CAMERA</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 判断程序是否有所需权限 android22 以上需要自申请权限 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">boolean</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">hasPermission</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">CordovaActivity</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">cordovaActivity</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">VERSION</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SDK_INT </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#A6ACCD;"> Build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">VERSION_CODES</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">M</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> i </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> Permission</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span><span style="color:#89DDFF;">;</span><span style="color:#A6ACCD;"> i</span><span style="color:#89DDFF;">++)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">cordovaActivity</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">checkSelfPermission</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Permission</span><span style="color:#89DDFF;">[</span><span style="color:#A6ACCD;">i</span><span style="color:#89DDFF;">])</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> PERMISSION_GRANTED</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">                    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false;</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">else</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 请求程序所需权限 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">requestPermission</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">CordovaActivity</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">cordovaActivity</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">VERSION</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">SDK_INT </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#A6ACCD;"> Build</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">VERSION_CODES</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">M</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            cordovaActivity</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">requestPermissions</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Permission</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> PERMISSIONS_REQUEST</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>在 Activity 中调用：</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">example</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">hello</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">android</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">os</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">Bundle</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">com</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">junl</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">cordova</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">PermissionUtil</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">org</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">apache</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">cordova</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">CordovaActivity</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">MainActivity</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">extends</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">CordovaActivity</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Override</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">onCreate</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">Bundle</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">savedInstanceState</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        super</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onCreate</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">savedInstanceState</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// 允许 Cordova 后台运行</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#C792EA;">Bundle</span><span style="color:#A6ACCD;"> extras </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">getIntent</span><span style="color:#89DDFF;">().</span><span style="color:#82AAFF;">getExtras</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">extras </span><span style="color:#89DDFF;">!=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&amp;&amp;</span><span style="color:#A6ACCD;"> extras</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getBoolean</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">cdvStartInBackground</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">false))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#82AAFF;">moveTaskToBack</span><span style="color:#89DDFF;">(true);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#676E95;font-style:italic;">/* 申请程序所需权限 */</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">(!</span><span style="color:#A6ACCD;">PermissionUtil</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">hasPermission</span><span style="color:#89DDFF;">(this))</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">            PermissionUtil</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">requestPermission</span><span style="color:#89DDFF;">(this);</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#82AAFF;">loadUrl</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">launchUrl</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">// loadUrl(&quot;https://www.baidu.com&quot;);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><h3 id="拍照裁剪保存问题" tabindex="-1">拍照裁剪保存问题 <a class="header-anchor" href="#拍照裁剪保存问题" aria-label="Permalink to &quot;拍照裁剪保存问题&quot;">​</a></h3><p>需要添加 <code>addFlags</code> 兼容高版本</p><div class="language-java line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// 剪裁</span></span>
<span class="line"><span style="color:#C792EA;">Intent</span><span style="color:#A6ACCD;"> crop </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;font-style:italic;">new</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Intent</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">com.android.camera.action.CROP</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">setDataAndType</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">fileUri</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">image/*</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">putExtra</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">scale</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">true);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 设置宽高比例</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">putExtra</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">aspectX</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">putExtra</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">aspectY</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 设置裁剪图片宽高</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">putExtra</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">outputX</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">340</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">putExtra</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">outputY</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">340</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">putExtra</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">MediaStore</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">EXTRA_OUTPUT</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> fileUri</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 高版本系统需要 addFlags</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addFlags</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Intent</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">FLAG_GRANT_WRITE_URI_PERMISSION</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">crop</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addFlags</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">Intent</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">FLAG_GRANT_READ_URI_PERMISSION</span><span style="color:#89DDFF;">);</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div>`,35),e=[o];function r(t,c,D,y,F,i){return n(),a("div",null,e)}const d=s(p,[["render",r]]);export{A as __pageData,d as default};
