import{_ as s,o as a,c as n,V as l}from"./chunks/framework.4acca30d.js";const m=JSON.parse('{"title":"Linux traceroute 命令排查网络状况","description":"","frontmatter":{"title":"Linux traceroute 命令排查网络状况","catalog":true,"date":"2018-11-21T16:50:24.000Z","subtitle":null,"header-img":null,"tags":["Linux"],"recommend":"linux-cmd"},"headers":[],"relativePath":"docs/os/linux-traceroute.md","filePath":"docs/os/linux-traceroute.md"}'),p={name:"docs/os/linux-traceroute.md"},o=l(`<h1 id="linux-traceroute-命令排查网络状况" tabindex="-1">Linux traceroute 命令排查网络状况 <a class="header-anchor" href="#linux-traceroute-命令排查网络状况" aria-label="Permalink to &quot;Linux traceroute 命令排查网络状况&quot;">​</a></h1><p>通过 <code>traceroute</code> 我们可以知道信息从你的计算机到互联网另一端的主机是走的什么路径。</p><p>当然每次数据包由某一同样的出发点（<code>source</code>）到达某一同样的目的地(<code>destination</code>)走的路径可能会不一样，但基本上来说大部分时候所走的路由是相同的。</p><p><code>linux</code> 系统中，我们称之为 <code>traceroute</code>,在 <code>MS Windows</code> 中为 <code>tracert</code>。</p><p><code>traceroute</code> 通过发送小的数据包到目的设备直到其返回，来测量其需要多长时间。一条路径上的每个设备 <code>traceroute</code> 要测 3 次。</p><p>输出结果中包括每次测试的时间(ms)和设备的名称（如有的话）及其 IP 地址。</p><p>在大多数情况下，我们会在 <code>linux</code> 主机系统下，直接执行命令行：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hostname</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>而在 <code>Windows</code> 系统下是执行 <code>tracert</code> 的命令：</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">tracert</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">hostname</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>linux</code> 下默认 <code>traceroute</code> 命令是通过 <code>UDP</code> 数据包进行跟踪路由，所以需要添加 <code>-I</code> 选项，这时候会通过 <code>ICMP</code> 协议跟踪。</p><h2 id="参数介绍" tabindex="-1">参数介绍 <a class="header-anchor" href="#参数介绍" aria-label="Permalink to &quot;参数介绍&quot;">​</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">-d 使用 Socket 层级的排错功能。</span></span>
<span class="line"><span style="color:#A6ACCD;">-f 设置第一个检测数据包的存活数值 TTL 的大小。</span></span>
<span class="line"><span style="color:#A6ACCD;">-F 设置勿离断位。</span></span>
<span class="line"><span style="color:#A6ACCD;">-g 设置来源路由网关，最多可设置 8 个。</span></span>
<span class="line"><span style="color:#A6ACCD;">-i 使用指定的网络界面送出数据包。</span></span>
<span class="line"><span style="color:#A6ACCD;">-I 使用 ICMP 回应取代 UDP 资料信息。</span></span>
<span class="line"><span style="color:#A6ACCD;">-m 设置检测数据包的最大存活数值 TTL 的大小。</span></span>
<span class="line"><span style="color:#A6ACCD;">-n 直接使用 IP 地址而非主机名称。</span></span>
<span class="line"><span style="color:#A6ACCD;">-p 设置 UDP 传输协议的通信端口。</span></span>
<span class="line"><span style="color:#A6ACCD;">-r 忽略普通的 Routing Table，直接将数据包送到远端主机上。</span></span>
<span class="line"><span style="color:#A6ACCD;">-s 设置本地主机送出数据包的 IP 地址。</span></span>
<span class="line"><span style="color:#A6ACCD;">-t 设置检测数据包的 TOS 数值。</span></span>
<span class="line"><span style="color:#A6ACCD;">-v 详细显示指令的执行过程。</span></span>
<span class="line"><span style="color:#A6ACCD;">-w 设置等待远端主机回报的时间。</span></span>
<span class="line"><span style="color:#A6ACCD;">-x 开启或关闭数据包的正确性检验。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="最常用的用法" tabindex="-1">最常用的用法 <a class="header-anchor" href="#最常用的用法" aria-label="Permalink to &quot;最常用的用法&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (61.135.169.125), 30 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.74.2</span><span style="color:#A6ACCD;"> (192.168.74.2)  2.606 ms  2.771 ms  2.950 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.56.57</span><span style="color:#A6ACCD;"> (211.151.56.57)  0.596 ms  0.598 ms  0.591 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.227.206</span><span style="color:#A6ACCD;"> (211.151.227.206)  0.546 ms  0.544 ms  0.538 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">210.77</span><span style="color:#C3E88D;">.139.145</span><span style="color:#A6ACCD;"> (210.77.139.145)  0.710 ms  0.748 ms  0.801 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">5</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.42.101</span><span style="color:#A6ACCD;"> (202.106.42.101)  6.759 ms  6.945 ms  7.107 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">6</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">61.148</span><span style="color:#C3E88D;">.154.97</span><span style="color:#A6ACCD;"> (61.148.154.97)  718.908 ms </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> bt-228-025.bta.net.cn </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">202.106.228.25</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  5.177 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">7</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">124.65</span><span style="color:#C3E88D;">.58.213</span><span style="color:#A6ACCD;"> (124.65.58.213)  4.343 ms  4.336 ms  4.367 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.35.190</span><span style="color:#A6ACCD;"> (202.106.35.190)  1.795 ms 61.148.156.138 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.156.138</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  1.899 ms  1.951 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">9</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#FFCB6B;">30</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>记录按序列号从 1 开始，每个纪录就是一跳 ，每跳表示一个网关，我们看到每行有三个时间，单位是 ms，其实就是-q 的默认参数。</p><p>探测数据包向每个网关发送三个数据包后，网关响应后返回的时间；如果您用 <code>traceroute -q 4 www.baidu.com</code> ，表示向每个网关发送 4 个数据包。</p><p>有时我们 <code>traceroute</code> 一台主机时，会看到有一些行是以星号表示的。</p><p>出现这样的情况，可能是防火墙封掉了 <code>ICMP</code> 的返回信息，所以我们得不到什么相关的数据包返回数据。</p><p>有时我们在某一网关处延时比较长，有可能是某台网关比较阻塞，也可能是物理设备本身的原因。</p><p>当然如果某台 <code>DNS</code> 出现问题时，不能解析主机名、域名时，也会 有延时长的现象；您可以加 <code>-n</code> 参数来避免 <code>DNS</code> 解析，以 <code>IP</code> 格式输出数据。</p><p>如果在局域网中的不同网段之间，我们可以通过 <code>traceroute</code> 来排查问题所在，是主机的问题还是网关的问题。</p><p>如果我们通过远程来访问某台服务器遇到问题时，我们用到 <code>traceroute</code> 追踪数据包所经过的网关，提交 <code>IDC</code> 服务商，也有助于解决问题；但目前看来在国内解决这样的问题是比较困难的，就是我们发现问题所在，<code>IDC</code> 服务商也不可能帮助我们解决。</p><h2 id="跳数设置" tabindex="-1">跳数设置 <a class="header-anchor" href="#跳数设置" aria-label="Permalink to &quot;跳数设置&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-m</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (61.135.169.105), 10 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">192.168</span><span style="color:#C3E88D;">.74.2</span><span style="color:#A6ACCD;"> (192.168.74.2)  1.534 ms  1.775 ms  1.961 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.56.1</span><span style="color:#A6ACCD;"> (211.151.56.1)  0.508 ms  0.514 ms  0.507 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.227.206</span><span style="color:#A6ACCD;"> (211.151.227.206)  0.571 ms  0.558 ms  0.550 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">210.77</span><span style="color:#C3E88D;">.139.145</span><span style="color:#A6ACCD;"> (210.77.139.145)  0.708 ms  0.729 ms  0.785 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">5</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.42.101</span><span style="color:#A6ACCD;"> (202.106.42.101)  7.978 ms  8.155 ms  8.311 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">6</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">bt-228-037.bta.net.cn</span><span style="color:#A6ACCD;"> (202.106.228.37)  772.460 ms bt-228-025.bta.net.cn </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">202.106.228.25</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  2.152 ms 61.148.154.97 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.154.97</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  772.107 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">7</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">124.65</span><span style="color:#C3E88D;">.58.221</span><span style="color:#A6ACCD;"> (124.65.58.221)  4.875 ms 61.148.146.29 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.146.29</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  2.124 ms 124.65.58.221 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">124.65.58.221</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  4.854 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">123.126</span><span style="color:#C3E88D;">.6.198</span><span style="color:#A6ACCD;"> (123.126.6.198)  2.944 ms 61.148.156.6 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.156.6</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  3.505 ms 123.126.6.198 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">123.126.6.198</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  2.885 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">9</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#FFCB6B;">10</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="显示-ip-地址-不查主机名" tabindex="-1">显示 IP 地址，不查主机名 <a class="header-anchor" href="#显示-ip-地址-不查主机名" aria-label="Permalink to &quot;显示 IP 地址，不查主机名&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-n</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (61.135.169.125), 30 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.74.2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">5.430</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">5.636</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">5.802</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.56.57</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.627</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.625</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.617</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.227.206</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.575</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.584</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.576</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">210.77</span><span style="color:#C3E88D;">.139.145</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.703</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.754</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">0.806</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">5</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.42.101</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">23.683</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">23.869</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">23.998</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">6</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.228.37</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">247.101</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">7</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">61.148</span><span style="color:#C3E88D;">.146.29</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">5.256</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">124.65</span><span style="color:#C3E88D;">.58.213</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">4.386</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">4.373</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.35.190</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">1.610</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">61.148</span><span style="color:#C3E88D;">.156.138</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">1.786</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">61.148</span><span style="color:#C3E88D;">.3.34</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">2.089</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">9</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#FFCB6B;">30</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="探测包使用的基本-udp-端口设置-6888" tabindex="-1">探测包使用的基本 UDP 端口设置 6888 <a class="header-anchor" href="#探测包使用的基本-udp-端口设置-6888" aria-label="Permalink to &quot;探测包使用的基本 UDP 端口设置 6888&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-p</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">6888</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (220.181.111.147), 30 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.74.2</span><span style="color:#A6ACCD;"> (211.151.74.2)  4.927 ms  5.121 ms  5.298 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.56.1</span><span style="color:#A6ACCD;"> (211.151.56.1)  0.500 ms  0.499 ms  0.509 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.224.90</span><span style="color:#A6ACCD;"> (211.151.224.90)  0.637 ms  0.631 ms  0.641 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">5</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">220.181</span><span style="color:#C3E88D;">.70.98</span><span style="color:#A6ACCD;"> (220.181.70.98)  5.050 ms  5.313 ms  5.596 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">6</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">220.181</span><span style="color:#C3E88D;">.17.94</span><span style="color:#A6ACCD;"> (220.181.17.94)  1.665 ms </span><span style="color:#89DDFF;">!</span><span style="color:#FFCB6B;">X</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="把探测包的个数设置为值-4" tabindex="-1">把探测包的个数设置为值 4 <a class="header-anchor" href="#把探测包的个数设置为值-4" aria-label="Permalink to &quot;把探测包的个数设置为值 4&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-q</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (61.135.169.125), 30 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.74.2</span><span style="color:#A6ACCD;"> (211.151.74.2)  40.633 ms  40.819 ms  41.004 ms  41.188 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.56.57</span><span style="color:#A6ACCD;"> (211.151.56.57)  0.637 ms  0.633 ms  0.627 ms  0.619 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.227.206</span><span style="color:#A6ACCD;"> (211.151.227.206)  0.505 ms  0.580 ms  0.571 ms  0.569 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">210.77</span><span style="color:#C3E88D;">.139.145</span><span style="color:#A6ACCD;"> (210.77.139.145)  0.753 ms  0.800 ms  0.853 ms  0.904 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">5</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.42.101</span><span style="color:#A6ACCD;"> (202.106.42.101)  7.449 ms  7.543 ms  7.738 ms  7.893 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">6</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">61.148</span><span style="color:#C3E88D;">.154.97</span><span style="color:#A6ACCD;"> (61.148.154.97)  316.817 ms bt-228-025.bta.net.cn </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">202.106.228.25</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  3.695 ms  3.672 ms </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">7</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">124.65</span><span style="color:#C3E88D;">.58.213</span><span style="color:#A6ACCD;"> (124.65.58.213)  3.056 ms  2.993 ms  2.960 ms 61.148.146.29 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.146.29</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  2.837 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">61.148</span><span style="color:#C3E88D;">.3.34</span><span style="color:#A6ACCD;"> (61.148.3.34)  2.179 ms  2.295 ms  2.442 ms 202.106.35.190 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">202.106.35.190</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  7.136 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">9</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#FFCB6B;">30</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="绕过正常的路由表-直接发送到网络相连的主机" tabindex="-1">绕过正常的路由表，直接发送到网络相连的主机 <a class="header-anchor" href="#绕过正常的路由表-直接发送到网络相连的主机" aria-label="Permalink to &quot;绕过正常的路由表，直接发送到网络相连的主机&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-r</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (61.135.169.125), 30 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#FFCB6B;">connect:</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">网络不可达</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="把对外发探测包的等待响应时间设置为-3-秒" tabindex="-1">把对外发探测包的等待响应时间设置为 3 秒 <a class="header-anchor" href="#把对外发探测包的等待响应时间设置为-3-秒" aria-label="Permalink to &quot;把对外发探测包的等待响应时间设置为 3 秒&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-w</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span></span>
<span class="line"><span style="color:#FFCB6B;">traceroute</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">www.baidu.com</span><span style="color:#A6ACCD;"> (61.135.169.105), 30 hops max, 40 byte packets</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">1</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.74.2</span><span style="color:#A6ACCD;"> (211.151.74.2)  2.306 ms  2.469 ms  2.650 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">2</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.56.1</span><span style="color:#A6ACCD;"> (211.151.56.1)  0.621 ms  0.613 ms  0.603 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">3</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">211.151</span><span style="color:#C3E88D;">.227.206</span><span style="color:#A6ACCD;"> (211.151.227.206)  0.557 ms  0.560 ms  0.552 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">4</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">210.77</span><span style="color:#C3E88D;">.139.145</span><span style="color:#A6ACCD;"> (210.77.139.145)  0.708 ms  0.761 ms  0.817 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">5</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">202.106</span><span style="color:#C3E88D;">.42.101</span><span style="color:#A6ACCD;"> (202.106.42.101)  7.520 ms  7.774 ms  7.902 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">6</span><span style="color:#A6ACCD;">  </span><span style="color:#C3E88D;">bt-228-025.bta.net.cn</span><span style="color:#A6ACCD;"> (202.106.228.25)  2.890 ms  2.369 ms 61.148.154.97 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.154.97</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  471.961 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">7</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">124.65</span><span style="color:#C3E88D;">.58.221</span><span style="color:#A6ACCD;"> (124.65.58.221)  4.490 ms  4.483 ms  4.472 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">8</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">123.126</span><span style="color:#C3E88D;">.6.198</span><span style="color:#A6ACCD;"> (123.126.6.198)  2.948 ms 61.148.156.6 </span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">61.148.156.6</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;">  7.688 ms  7.756 ms</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">9</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span>
<span class="line"><span style="color:#FFCB6B;">30</span><span style="color:#A6ACCD;">  </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;">*</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="traceroute-的工作原理" tabindex="-1">Traceroute 的工作原理 <a class="header-anchor" href="#traceroute-的工作原理" aria-label="Permalink to &quot;Traceroute 的工作原理&quot;">​</a></h2><p><code>Traceroute</code> 最简单的基本用法是：<code>traceroute hostname</code></p><p><code>Traceroute</code> 程序的设计是利用 <code>ICMP</code> 及 <code>IP header</code> 的 <code>TTL（Time To Live）</code> 栏位 <code>field\`\`。首先，traceroute</code> 送出一个 <code>TTL</code> 是 1 的 <code>IP datagram</code>（其实，每次送出的为 3 个 40 字节的包，包括源地址，目的地址和包发出的时间标签）到目的地，当路径上的第一个路由器 <code>router</code> 收到这个 <code>datagram</code> 时，它将 <code>TTL</code> 减 1。</p><p>此时，<code>TTL</code> 变为 0 了，所以该路由器会将此 <code>datagram</code> 丢掉，并送回一个 <code>ICMP time exceeded</code> 消息（包括发 <code>IP</code> 包的源地址，<code>IP</code> 包的所有内容及路由器的 <code>IP</code> 地址），<code>traceroute</code> 收到这个消息后，便知道这个路由器存在于这个路径上，接着 <code>traceroute</code> 再送出另一个 <code>TTL</code> 是 2 的 <code>datagram</code>，发现第 2 个路由器...... <code>traceroute</code> 每次将送出的 <code>datagram</code> 的 <code>TTL</code> 加 1 来发现另一个路由器，这个重复的动作一直持续到某个 <code>datagram</code> 抵达目的地。当 <code>datagram</code> 到达目的地后，该主机并不会送回 <code>ICMP time exceeded</code> 消息，因为它已是目的地了，那么 <code>traceroute</code> 如何得知目的地到达了呢？</p><p><code>Traceroute</code> 在送出 <code>UDP datagrams</code> 到目的地时，它所选择送达的 <code>port number</code> 是一个一般应用程序都不会用的号码（30000 以上），所以当此 <code>UDP datagram</code> 到达目的地后该主机会送回一个 <code>ICMP port unreachable</code> 的消息，而当 <code>traceroute</code> 收到这个消息时，便知道目的地已经到达了。所以 <code>traceroute</code> 在 <code>Server</code> 端也是没有所谓的 <code>Daemon</code> 程式。</p><p><code>Traceroute</code> 提取发 <code>ICMP TTL</code> 到期消息设备的 <code>IP</code> 地址并作域名解析。每次 ，<code>Traceroute</code> 都打印出一系列数据,包括所经过的路由设备的域名及 <code>IP</code> 地址,三个包每次来回所花时间。</p>`,41),e=[o];function c(r,C,t,A,y,D){return a(),n("div",null,e)}const d=s(p,[["render",c]]);export{m as __pageData,d as default};
