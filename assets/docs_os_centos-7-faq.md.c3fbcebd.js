import{_ as s,o as a,c as n,Q as l}from"./chunks/framework.a5795de3.js";const b=JSON.parse('{"title":"CentOS 7 FAQ","description":"","frontmatter":{"title":"CentOS 7 FAQ","catalog":true,"date":"2018-05-12T21:10:00.000Z","subtitle":null,"header-img":null,"tags":["Linux"],"recommend":"CentOS"},"headers":[],"relativePath":"docs/os/centos-7-faq.md","filePath":"docs/os/centos-7-faq.md"}'),p={name:"docs/os/centos-7-faq.md"},o=l(`<h1 id="centos-7-faq" tabindex="-1">CentOS 7 FAQ <a class="header-anchor" href="#centos-7-faq" aria-label="Permalink to &quot;CentOS 7 FAQ&quot;">​</a></h1><blockquote><p>本来一直用的 ArchLinux，不过 Arch 其实不适合作为服务器使用，因为其滚动更新的特性使得服务器不稳定。</p></blockquote><h2 id="centos-如何安装最新版本的-gcc-编译器" tabindex="-1">CentOS 如何安装最新版本的 GCC 编译器 <a class="header-anchor" href="#centos-如何安装最新版本的-gcc-编译器" aria-label="Permalink to &quot;CentOS 如何安装最新版本的 GCC 编译器&quot;">​</a></h2><p>默认没做任何设置的情况下，yum 安装的 GCC 版本比较陈旧。如果想安装较新的版本，需要如下操作：</p><h3 id="gcc-4-9-安装" tabindex="-1">GCC 4.9 安装 <a class="header-anchor" href="#gcc-4-9-安装" aria-label="Permalink to &quot;GCC 4.9 安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">centos-release-scl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">devtoolset-3-toolchain</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span>
<span class="line"><span style="color:#B392F0;">scl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">devtoolset-3</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span></span>
<span class="line"><span style="color:#B392F0;">gcc</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-v</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">centos-release-scl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">devtoolset-3-toolchain</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span>
<span class="line"><span style="color:#6F42C1;">scl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">devtoolset-3</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span></span>
<span class="line"><span style="color:#6F42C1;">gcc</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-v</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="gcc-5-2-安装" tabindex="-1">GCC 5.2 安装 <a class="header-anchor" href="#gcc-5-2-安装" aria-label="Permalink to &quot;GCC 5.2 安装&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">centos-release-scl</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">devtoolset-4-toolchain</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-y</span></span>
<span class="line"><span style="color:#B392F0;">scl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">enable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">devtoolset-4</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">bash</span></span>
<span class="line"><span style="color:#B392F0;">gcc</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--version</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">centos-release-scl</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">devtoolset-4-toolchain</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-y</span></span>
<span class="line"><span style="color:#6F42C1;">scl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">enable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">devtoolset-4</span><span style="color:#24292E;"> </span><span style="color:#032F62;">bash</span></span>
<span class="line"><span style="color:#6F42C1;">gcc</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--version</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="centos7-安装完毕后无法联网的解决方法" tabindex="-1">Centos7 安装完毕后无法联网的解决方法 <a class="header-anchor" href="#centos7-安装完毕后无法联网的解决方法" aria-label="Permalink to &quot;Centos7 安装完毕后无法联网的解决方法&quot;">​</a></h2><p>进入目录：</p><p><code>/etc/sysconfig/network-scripts/</code></p><p>ls 命令查看网卡配置文件名（在 CENTOS7 中网卡名貌似变成了随机数字，所以每台机器的网卡名并不相同）</p><p>比如：<code>ifcfg-enoxxxxxx</code></p><p>将最后一行的 ONBOOT=no 改为 ONBOOT=yes, 如图 最后输入：wq 保存并退出，再重启一下 network：</p><p><code>service network restart</code></p><h2 id="如何增加桌面环境" tabindex="-1">如何增加桌面环境 <a class="header-anchor" href="#如何增加桌面环境" aria-label="Permalink to &quot;如何增加桌面环境&quot;">​</a></h2><p>KDE</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">groupinstall</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;KDE Plasma Workspaces&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">groupinstall</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;KDE Plasma Workspaces&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>GNOME</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">groupinstall</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">&quot;GNOME Desktop&quot;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">groupinstall</span><span style="color:#24292E;"> </span><span style="color:#032F62;">&quot;GNOME Desktop&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>启动（基于 systemd)</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">get-default</span></span>
<span class="line"><span style="color:#B392F0;">systemctl</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">set-default</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">graphical.target</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">get-default</span></span>
<span class="line"><span style="color:#6F42C1;">systemctl</span><span style="color:#24292E;"> </span><span style="color:#032F62;">set-default</span><span style="color:#24292E;"> </span><span style="color:#032F62;">graphical.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="yum-和-rpm-常用命令备忘录" tabindex="-1">Yum 和 RPM 常用命令备忘录 <a class="header-anchor" href="#yum-和-rpm-常用命令备忘录" aria-label="Permalink to &quot;Yum 和 RPM 常用命令备忘录&quot;">​</a></h2><p>yum history</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">history</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">history</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">list</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">history</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">info</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">history</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">undo</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">history</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">redo</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">I</span><span style="color:#E1E4E8;">D</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">history</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">history</span><span style="color:#24292E;"> </span><span style="color:#032F62;">list</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">history</span><span style="color:#24292E;"> </span><span style="color:#032F62;">info</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">history</span><span style="color:#24292E;"> </span><span style="color:#032F62;">undo</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">history</span><span style="color:#24292E;"> </span><span style="color:#032F62;">redo</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">I</span><span style="color:#24292E;">D</span><span style="color:#D73A49;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>yum update</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">clean</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">all</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">makecache</span></span>
<span class="line"><span style="color:#B392F0;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">update</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">clean</span><span style="color:#24292E;"> </span><span style="color:#032F62;">all</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">makecache</span></span>
<span class="line"><span style="color:#6F42C1;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">update</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>rpm 安装卸载</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-ivh</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#9ECBFF;">.rpm</span></span>
<span class="line"><span style="color:#B392F0;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-qa</span></span>
<span class="line"><span style="color:#B392F0;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-qa</span><span style="color:#F97583;">|</span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span></span>
<span class="line"><span style="color:#B392F0;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-e</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span></span>
<span class="line"><span style="color:#B392F0;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-e</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">*</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--nodeps</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">rpm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-ivh</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#032F62;">.rpm</span></span>
<span class="line"><span style="color:#6F42C1;">rpm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-qa</span></span>
<span class="line"><span style="color:#6F42C1;">rpm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-qa</span><span style="color:#D73A49;">|</span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span></span>
<span class="line"><span style="color:#6F42C1;">rpm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span></span>
<span class="line"><span style="color:#6F42C1;">rpm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-e</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">*</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--nodeps</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="如何从-yum-库下载-rpm-包但不安装" tabindex="-1">如何从 Yum 库下载 rpm 包但不安装 <a class="header-anchor" href="#如何从-yum-库下载-rpm-包但不安装" aria-label="Permalink to &quot;如何从 Yum 库下载 rpm 包但不安装&quot;">​</a></h2><h3 id="方法一-yum" tabindex="-1">方法一：yum <a class="header-anchor" href="#方法一-yum" aria-label="Permalink to &quot;方法一：yum&quot;">​</a></h3><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--downloadonly</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">package-nam</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--downloadonly</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">package-nam</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>默认情况下，一个下载的 RPM 包会保存在下面的目录中： <code>/var/cache/yum/x86_64/[centos/fedora-version]/[repository]/packages</code> 以上的 <code>[repository]</code> 表示下载包的来源仓库的名称（例如：base、fedora、updates)</p><p>如果你想要将一个包下载到一个指定的目录（如 /tmp)：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--downloadonly</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--downloaddir=/tmp</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">package-nam</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--downloadonly</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--downloaddir=/tmp</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">package-nam</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>注意，如果下载的包包含了任何没有满足的依赖关系，yum 将会把所有的依赖关系包下载，但是都不会被安装。 另外一个重要的事情是，在 <code>CentOS/RHEL 6</code> 或更早期的版本中，你需要安装一个单独 yum 插件（名称为 <code>yum-plugin-downloadonly</code>) 才能使用 <code>--downloadonly</code> 命令选项：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yum-plugin-downloadonly</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yum-plugin-downloadonly</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>如果没有该插件，你会在使用 yum 时得到以下错误：</p><p><code>Command line error: no such option: --downloadonly</code></p><h3 id="方法二-yumdownloader" tabindex="-1">方法二：Yumdownloader <a class="header-anchor" href="#方法二-yumdownloader" aria-label="Permalink to &quot;方法二：Yumdownloader&quot;">​</a></h3><p>另外一个下载 RPM 包的方法就是通过一个专门的包下载工具 --yumdownloader。 这个工具是 yum 工具包（包含了用来进行 yum 包管理的帮助工具套件) 的子集。</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yum</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">install</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yum-utils</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yum</span><span style="color:#24292E;"> </span><span style="color:#032F62;">install</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yum-utils</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>下载一个 RPM 包：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yumdownloader</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">&lt;</span><span style="color:#9ECBFF;">package-nam</span><span style="color:#E1E4E8;">e</span><span style="color:#F97583;">&gt;</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yumdownloader</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">&lt;</span><span style="color:#032F62;">package-nam</span><span style="color:#24292E;">e</span><span style="color:#D73A49;">&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>下载的包会被保存在当前目录中。你需要使用 root 权限，因为 yumdownloader 会在下载过程中更新包索引文件。与 yum 命令不同的是，任何依赖包不会被下载。</p><p>下载 lsof 示例：</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">sudo</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yumdownloader</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">lsof</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--resolve</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--destdir=/data/mydepot/</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">sudo</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yumdownloader</span><span style="color:#24292E;"> </span><span style="color:#032F62;">lsof</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--resolve</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--destdir=/data/mydepot/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><code>--resolve</code> 表示为下载依赖</p><h2 id="centos-samba-服务器配置" tabindex="-1">CentOS Samba 服务器配置 <a class="header-anchor" href="#centos-samba-服务器配置" aria-label="Permalink to &quot;CentOS Samba 服务器配置&quot;">​</a></h2><p>Samba 是 SMB 的一种实现方法，主要用来实现 Linux 系统的文件和打印服务。Linux 用户通过配置使用 Samba 服务器可以实现与 Windows 用户的资源共享。守护进程 smbd 和 nmbd 是 Samba 的核心，在全部时间内运行。nmbd 程序使得通过企图计算机可以浏览 Linux 服务器。</p><h3 id="一、安装前准备" tabindex="-1">一、安装前准备 <a class="header-anchor" href="#一、安装前准备" aria-label="Permalink to &quot;一、安装前准备&quot;">​</a></h3><p>1、 使用 Samba 服务器需要防火墙开放以下端口</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">UDP</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">137</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">UDP</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">138</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">TCP</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">139</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">TCP</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">445</span></span>
<span class="line"><span style="color:#6A737D;">## 配置防火墙端口</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">UDP</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">137</span><span style="color:#24292E;"> </span><span style="color:#032F62;">UDP</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">138</span><span style="color:#24292E;"> </span><span style="color:#032F62;">TCP</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">139</span><span style="color:#24292E;"> </span><span style="color:#032F62;">TCP</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">445</span></span>
<span class="line"><span style="color:#6A737D;">## 配置防火墙端口</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">vi</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/sysconfig/iptables</span></span>
<span class="line"></span>
<span class="line"><span style="color:#B392F0;">-A</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INPUT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">state</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NEW</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tcp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tcp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--dport</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">139</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-j</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ACCEPT</span></span>
<span class="line"><span style="color:#B392F0;">-A</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INPUT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">state</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NEW</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tcp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">tcp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--dport</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">445</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-j</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ACCEPT</span></span>
<span class="line"><span style="color:#B392F0;">-A</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INPUT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">state</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NEW</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">udp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">udp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--dport</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">137</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-j</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ACCEPT</span></span>
<span class="line"><span style="color:#B392F0;">-A</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">INPUT</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">state</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--state</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">NEW</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-m</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">udp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">udp</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">--dport</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">138</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-j</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">ACCEPT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## 重启防火墙，使规则生效</span></span>
<span class="line"><span style="color:#B392F0;">/etc/rc.d/init.d/iptables</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">vi</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/sysconfig/iptables</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;">-A</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INPUT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">state</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NEW</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tcp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tcp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--dport</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">139</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-j</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ACCEPT</span></span>
<span class="line"><span style="color:#6F42C1;">-A</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INPUT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">state</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NEW</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tcp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">tcp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--dport</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">445</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-j</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ACCEPT</span></span>
<span class="line"><span style="color:#6F42C1;">-A</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INPUT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">state</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NEW</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">udp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">udp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--dport</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">137</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-j</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ACCEPT</span></span>
<span class="line"><span style="color:#6F42C1;">-A</span><span style="color:#24292E;"> </span><span style="color:#032F62;">INPUT</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">state</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--state</span><span style="color:#24292E;"> </span><span style="color:#032F62;">NEW</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-m</span><span style="color:#24292E;"> </span><span style="color:#032F62;">udp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">udp</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">--dport</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">138</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-j</span><span style="color:#24292E;"> </span><span style="color:#032F62;">ACCEPT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;">## 重启防火墙，使规则生效</span></span>
<span class="line"><span style="color:#6F42C1;">/etc/rc.d/init.d/iptables</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>2、关闭 CentOS6 系统的 SELinux</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">vi</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/selinux/config</span></span>
<span class="line"><span style="color:#6A737D;">## SELINUX=enforcing     #注释掉</span></span>
<span class="line"><span style="color:#6A737D;">## SELINUXTYPE=targeted  #注释掉</span></span>
<span class="line"><span style="color:#E1E4E8;">SELINUX</span><span style="color:#F97583;">=</span><span style="color:#9ECBFF;">disabled</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;">#增加</span></span>
<span class="line"><span style="color:#6A737D;">## :wq  保存。</span></span>
<span class="line"><span style="color:#6A737D;">## 重启系统</span></span>
<span class="line"><span style="color:#B392F0;">shutdown</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-r</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">now</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">或者</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">init</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">6</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">vi</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/selinux/config</span></span>
<span class="line"><span style="color:#6A737D;">## SELINUX=enforcing     #注释掉</span></span>
<span class="line"><span style="color:#6A737D;">## SELINUXTYPE=targeted  #注释掉</span></span>
<span class="line"><span style="color:#24292E;">SELINUX</span><span style="color:#D73A49;">=</span><span style="color:#032F62;">disabled</span><span style="color:#24292E;">       </span><span style="color:#6A737D;">#增加</span></span>
<span class="line"><span style="color:#6A737D;">## :wq  保存。</span></span>
<span class="line"><span style="color:#6A737D;">## 重启系统</span></span>
<span class="line"><span style="color:#6F42C1;">shutdown</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-r</span><span style="color:#24292E;"> </span><span style="color:#032F62;">now</span><span style="color:#24292E;">  </span><span style="color:#032F62;">或者</span><span style="color:#24292E;"> </span><span style="color:#032F62;">init</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">6</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="二、安装-samba" tabindex="-1">二、安装 Samba <a class="header-anchor" href="#二、安装-samba" aria-label="Permalink to &quot;二、安装 Samba&quot;">​</a></h3><p>1 、检查 Samba 服务包是否已安装</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-qa</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">|</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">grep</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">samba</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">samba-3.5.4-68.el6.x86_64</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">samba-common-3.5.4-68.el6.x86_64</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">samba-client-3.5.4-68.el6.x86_64</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">samba4-libs-4.0.0-23.alpha11.el6.x86_64</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">samba-winbind-clients-3.5.4-68.el6.x86_64</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">rpm</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-qa</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">|</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">grep</span><span style="color:#24292E;"> </span><span style="color:#032F62;">samba</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">samba-3.5.4-68.el6.x86_64</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">samba-common-3.5.4-68.el6.x86_64</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">samba-client-3.5.4-68.el6.x86_64</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">samba4-libs-4.0.0-23.alpha11.el6.x86_64</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">samba-winbind-clients-3.5.4-68.el6.x86_64</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>说明 samba 已经安装，如果没有安装，运行下面命令安装</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[root@ www </span><span style="color:#F97583;">~</span><span style="color:#E1E4E8;">] yum install samba</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[root@ www </span><span style="color:#D73A49;">~</span><span style="color:#24292E;">] yum install samba</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>2、配置 samba</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">chkconfig</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">smb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">on</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">## 设置 Samba 开机自动启动</span></span>
<span class="line"><span style="color:#B392F0;">service</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">smb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">start</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;">## 启动 Samba 服务</span></span>
<span class="line"><span style="color:#B392F0;">/etc/init.d/smb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span><span style="color:#E1E4E8;">  </span><span style="color:#6A737D;">## 重启</span></span>
<span class="line"><span style="color:#B392F0;">/etc/init.d/smb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stop</span><span style="color:#E1E4E8;">     </span><span style="color:#6A737D;">## 停止</span></span>
<span class="line"><span style="color:#B392F0;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/samba/smb.conf</span><span style="color:#E1E4E8;">   </span><span style="color:#9ECBFF;">/etc/samba/bak_smb.conf_bak</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">## 备份</span></span>
<span class="line"><span style="color:#B392F0;">cp</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/samba/bak_smb.conf_bak</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">/etc/samba/smb.conf</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">## 恢复</span></span>
<span class="line"><span style="color:#B392F0;">vi</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/etc/samba/smb.conf</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">chkconfig</span><span style="color:#24292E;"> </span><span style="color:#032F62;">smb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">on</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">## 设置 Samba 开机自动启动</span></span>
<span class="line"><span style="color:#6F42C1;">service</span><span style="color:#24292E;"> </span><span style="color:#032F62;">smb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">start</span><span style="color:#24292E;">       </span><span style="color:#6A737D;">## 启动 Samba 服务</span></span>
<span class="line"><span style="color:#6F42C1;">/etc/init.d/smb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span><span style="color:#24292E;">  </span><span style="color:#6A737D;">## 重启</span></span>
<span class="line"><span style="color:#6F42C1;">/etc/init.d/smb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stop</span><span style="color:#24292E;">     </span><span style="color:#6A737D;">## 停止</span></span>
<span class="line"><span style="color:#6F42C1;">cp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/samba/smb.conf</span><span style="color:#24292E;">   </span><span style="color:#032F62;">/etc/samba/bak_smb.conf_bak</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">## 备份</span></span>
<span class="line"><span style="color:#6F42C1;">cp</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/samba/bak_smb.conf_bak</span><span style="color:#24292E;">  </span><span style="color:#032F62;">/etc/samba/smb.conf</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">## 恢复</span></span>
<span class="line"><span style="color:#6F42C1;">vi</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/etc/samba/smb.conf</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#E1E4E8;">[global]                           </span><span style="color:#6A737D;">## 找到这一行（全局设置标签），在此行下面添加如下行：</span></span>
<span class="line"><span style="color:#B392F0;">workgroup</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">WORKGROUP</span><span style="color:#E1E4E8;">          </span><span style="color:#6A737D;">## 工作组名称改为 Windows 网络所定义的工作组名</span></span>
<span class="line"><span style="color:#B392F0;">server</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">string</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Samba</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">Server</span><span style="color:#E1E4E8;">   </span><span style="color:#6A737D;">## 设置 samba 服务器的主机名称</span></span>
<span class="line"><span style="color:#B392F0;">security</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user</span><span style="color:#E1E4E8;">                </span><span style="color:#6A737D;">## 设置 samba 服务器安全级别为 user，即以账号和口令访问</span></span>
<span class="line"><span style="color:#B392F0;">netbios</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">name</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SambaServer</span><span style="color:#E1E4E8;">     </span><span style="color:#6A737D;">## 设置 Samba 服务器访问别名</span></span>
<span class="line"><span style="color:#6A737D;">#在配置文件的末尾添加以下自定义内容</span></span>
<span class="line"><span style="color:#E1E4E8;">[SambaServer]                      </span><span style="color:#6A737D;">## 在 Windows 网上邻居中看到的共享目录的名字</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">comment</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SambaServer</span><span style="color:#E1E4E8;">          </span><span style="color:#6A737D;">## 在 Windows 网上邻居中看到的共享目录的备注信息</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">path</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home/SambaServer</span><span style="color:#E1E4E8;">       </span><span style="color:#6A737D;">## 共享目录在系统中的位置</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">no</span><span style="color:#E1E4E8;">                    </span><span style="color:#6A737D;">## 不公开目录</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">writable</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">=</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">yes</span><span style="color:#E1E4E8;">                 </span><span style="color:#6A737D;">## 共享目录可以读写</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#B392F0;">valid</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">users=SambaServer</span><span style="color:#E1E4E8;">        </span><span style="color:#6A737D;">## 只允许 SambaServer 用户访问</span></span>
<span class="line"><span style="color:#6A737D;">## 保存配置</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#24292E;">[global]                           </span><span style="color:#6A737D;">## 找到这一行（全局设置标签），在此行下面添加如下行：</span></span>
<span class="line"><span style="color:#6F42C1;">workgroup</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">WORKGROUP</span><span style="color:#24292E;">          </span><span style="color:#6A737D;">## 工作组名称改为 Windows 网络所定义的工作组名</span></span>
<span class="line"><span style="color:#6F42C1;">server</span><span style="color:#24292E;"> </span><span style="color:#032F62;">string</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Samba</span><span style="color:#24292E;"> </span><span style="color:#032F62;">Server</span><span style="color:#24292E;">   </span><span style="color:#6A737D;">## 设置 samba 服务器的主机名称</span></span>
<span class="line"><span style="color:#6F42C1;">security</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user</span><span style="color:#24292E;">                </span><span style="color:#6A737D;">## 设置 samba 服务器安全级别为 user，即以账号和口令访问</span></span>
<span class="line"><span style="color:#6F42C1;">netbios</span><span style="color:#24292E;"> </span><span style="color:#032F62;">name</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SambaServer</span><span style="color:#24292E;">     </span><span style="color:#6A737D;">## 设置 Samba 服务器访问别名</span></span>
<span class="line"><span style="color:#6A737D;">#在配置文件的末尾添加以下自定义内容</span></span>
<span class="line"><span style="color:#24292E;">[SambaServer]                      </span><span style="color:#6A737D;">## 在 Windows 网上邻居中看到的共享目录的名字</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">comment</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SambaServer</span><span style="color:#24292E;">          </span><span style="color:#6A737D;">## 在 Windows 网上邻居中看到的共享目录的备注信息</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">path</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home/SambaServer</span><span style="color:#24292E;">       </span><span style="color:#6A737D;">## 共享目录在系统中的位置</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">public</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">no</span><span style="color:#24292E;">                    </span><span style="color:#6A737D;">## 不公开目录</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">writable</span><span style="color:#24292E;"> </span><span style="color:#032F62;">=</span><span style="color:#24292E;"> </span><span style="color:#032F62;">yes</span><span style="color:#24292E;">                 </span><span style="color:#6A737D;">## 共享目录可以读写</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#6F42C1;">valid</span><span style="color:#24292E;"> </span><span style="color:#032F62;">users=SambaServer</span><span style="color:#24292E;">        </span><span style="color:#6A737D;">## 只允许 SambaServer 用户访问</span></span>
<span class="line"><span style="color:#6A737D;">## 保存配置</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>3、添加访问 linux 共享目录的账号 SambaServer</p><p>用户家目录为 /home/SambaServer, 用户登录终端设为 /bin/false（即使之不能登录系统)</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">mkdir</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-p</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home/SambaServer</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">#建立 SambaServer 文件夹</span></span>
<span class="line"><span style="color:#79B8FF;">cd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home/SambaServer</span></span>
<span class="line"><span style="color:#B392F0;">touch</span><span style="color:#E1E4E8;">  </span><span style="color:#9ECBFF;">samba.txt</span><span style="color:#E1E4E8;">    </span><span style="color:#6A737D;">#创建测试文件 samba.txt</span></span>
<span class="line"><span style="color:#B392F0;">useradd</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SambaServer</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-d</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home/SambaServer</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-s</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/bin/</span><span style="color:#79B8FF;">false</span></span>
<span class="line"><span style="color:#B392F0;">chown</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SambaServer:SambaServer</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">/home/SambaServer</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-R</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">mkdir</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-p</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home/SambaServer</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">#建立 SambaServer 文件夹</span></span>
<span class="line"><span style="color:#005CC5;">cd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home/SambaServer</span></span>
<span class="line"><span style="color:#6F42C1;">touch</span><span style="color:#24292E;">  </span><span style="color:#032F62;">samba.txt</span><span style="color:#24292E;">    </span><span style="color:#6A737D;">#创建测试文件 samba.txt</span></span>
<span class="line"><span style="color:#6F42C1;">useradd</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SambaServer</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-d</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home/SambaServer</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-s</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/bin/</span><span style="color:#005CC5;">false</span></span>
<span class="line"><span style="color:#6F42C1;">chown</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SambaServer:SambaServer</span><span style="color:#24292E;"> </span><span style="color:#032F62;">/home/SambaServer</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-R</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>4、将用户 SambaServer 添加入到 Samba 用户数据库，并设置登录共享目录的密码为：123456</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">smbpasswd</span><span style="color:#E1E4E8;"> </span><span style="color:#79B8FF;">-a</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SambaServer</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">New</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SMB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">password:</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">## 输入该用户用于登录 Samba 的密码</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">Retype</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SMB</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">password:</span><span style="color:#E1E4E8;"> </span><span style="color:#6A737D;">## 再次确认输入该密码</span></span>
<span class="line"><span style="color:#E1E4E8;">   </span><span style="color:#B392F0;">Added</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">user</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">SambaServer.</span></span>
<span class="line"><span style="color:#6A737D;">## 备注：这里设置的密码是 SambaServer 用户登录该机的 Samba 共享的密码，非登陆 OS 的密码；</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">smbpasswd</span><span style="color:#24292E;"> </span><span style="color:#005CC5;">-a</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SambaServer</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">New</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SMB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">password:</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">## 输入该用户用于登录 Samba 的密码</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">Retype</span><span style="color:#24292E;"> </span><span style="color:#032F62;">new</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SMB</span><span style="color:#24292E;"> </span><span style="color:#032F62;">password:</span><span style="color:#24292E;"> </span><span style="color:#6A737D;">## 再次确认输入该密码</span></span>
<span class="line"><span style="color:#24292E;">   </span><span style="color:#6F42C1;">Added</span><span style="color:#24292E;"> </span><span style="color:#032F62;">user</span><span style="color:#24292E;"> </span><span style="color:#032F62;">SambaServer.</span></span>
<span class="line"><span style="color:#6A737D;">## 备注：这里设置的密码是 SambaServer 用户登录该机的 Samba 共享的密码，非登陆 OS 的密码；</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>5、重启 Samba 服务器</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">/etc/init.d/smb</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">restart</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">/etc/init.d/smb</span><span style="color:#24292E;"> </span><span style="color:#032F62;">restart</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>6、浏览共享信息 在 Windows 客户端输入 <code>\\\\ip</code> 或者 <code>\\\\SambaServer</code> 服务器别名</p><p>回车之后，会跳出来登录框，输入账号 SambaServer , 密码 123456 , 即可访问共享目录</p><p>至此，CentOS 6 linux samba 服务器配置完成。</p><p>服务名：smb 配置目录：<code>/etc/sabma/</code> 主配置文件：<code>/etc/sabma/smb.conf</code></p><p>问题： 如果无法访问共享目录的内容，请把防火墙停止；</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">service</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">iptables</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stop</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">service</span><span style="color:#24292E;"> </span><span style="color:#032F62;">iptables</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stop</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="「rpm」error-in-preun-scriptlet-file-was-supposed-to-be-removed-but-is-not" tabindex="-1">「RPM」Error in PREUN scriptlet … file was supposed to be removed but is not <a class="header-anchor" href="#「rpm」error-in-preun-scriptlet-file-was-supposed-to-be-removed-but-is-not" aria-label="Permalink to &quot;「RPM」Error in PREUN scriptlet … file was supposed to be removed but is not&quot;">​</a></h2><blockquote><p><a href="http://www.linux-pages.com/2012/08/error-in-preun-scriptlet-file-was-supposed-to-be-removed-but-is-not/" target="_blank" rel="noreferrer">http://www.linux-pages.com/2012/08/error-in-preun-scriptlet-file-was-supposed-to-be-removed-but-is-not/</a></p></blockquote><p>Sometimes a yum/RPM package would get “stuck” and just won’t go away. Actually usually the package is already gone but yum/rpm fails to update it’s internal DB and still thinks it is there.</p><p>The error one usually sees in such cases is something like:</p><div class="language-bash vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#B392F0;">Error</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">PREUN</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">scriptlet</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">in</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">rpm</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">package</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">stlinux23-sh4_uclibc-which</span></span>
<span class="line"><span style="color:#B392F0;">stlinux23-sh4_uclibc-which-2.16-5.sh4_uclibc</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">was</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">supposed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">to</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">be</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">removed</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">but</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">is</span><span style="color:#E1E4E8;"> </span><span style="color:#9ECBFF;">not!</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#6F42C1;">Error</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">PREUN</span><span style="color:#24292E;"> </span><span style="color:#032F62;">scriptlet</span><span style="color:#24292E;"> </span><span style="color:#032F62;">in</span><span style="color:#24292E;"> </span><span style="color:#032F62;">rpm</span><span style="color:#24292E;"> </span><span style="color:#032F62;">package</span><span style="color:#24292E;"> </span><span style="color:#032F62;">stlinux23-sh4_uclibc-which</span></span>
<span class="line"><span style="color:#6F42C1;">stlinux23-sh4_uclibc-which-2.16-5.sh4_uclibc</span><span style="color:#24292E;"> </span><span style="color:#032F62;">was</span><span style="color:#24292E;"> </span><span style="color:#032F62;">supposed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">to</span><span style="color:#24292E;"> </span><span style="color:#032F62;">be</span><span style="color:#24292E;"> </span><span style="color:#032F62;">removed</span><span style="color:#24292E;"> </span><span style="color:#032F62;">but</span><span style="color:#24292E;"> </span><span style="color:#032F62;">is</span><span style="color:#24292E;"> </span><span style="color:#032F62;">not!</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>So in my case the package stlinux23-sh4_uclibc-which-2.16-5.sh4_uclibc is causing problems, it will be soemthing different in your case</p><p>To fix the problem run:</p><p><code>yum --setopt=tsflags=noscripts remove stlinux23-sh4_uclibc-which.sh4_uclibc</code></p><p>You can add more than one package file to the end of the command.</p><h2 id="「java」org-quartz-schedulerexception-couldn-t-get-host-name" tabindex="-1">「Java」org.quartz.SchedulerException: Couldn&#39;t get host name! <a class="header-anchor" href="#「java」org-quartz-schedulerexception-couldn-t-get-host-name" aria-label="Permalink to &quot;「Java」org.quartz.SchedulerException: Couldn&#39;t get host name!&quot;">​</a></h2><blockquote><p>&lt;<a href="https://blog.csdn.net/Lumia10200/article/details/52670231" target="_blank" rel="noreferrer">https://blog.csdn.net/Lumia10200/article/details/52670231</a> &gt;</p></blockquote><p>使用 quartz 做集群任务的时候，在本地和测试环境正常，部署上线的时候， 启动异常：org.quartz.SchedulerException: Couldn&#39;t get host name!</p><p>这个是 org.quartz.simpl.SimpleInstanceIdGenerator 中获取主机名异常了</p><div class="language-java vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki github-dark vp-code-dark"><code><span class="line"><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">class</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SimpleInstanceIdGenerator</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">implements</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">InstanceIdGenerator</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">    </span><span style="color:#F97583;">public</span><span style="color:#E1E4E8;"> String </span><span style="color:#B392F0;">generateInstanceId</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">throws</span><span style="color:#E1E4E8;"> SchedulerException {</span></span>
<span class="line"><span style="color:#E1E4E8;">        </span><span style="color:#F97583;">try</span><span style="color:#E1E4E8;"> {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">return</span><span style="color:#E1E4E8;"> InetAddress.</span><span style="color:#B392F0;">getLocalHost</span><span style="color:#E1E4E8;">().</span><span style="color:#B392F0;">getHostName</span><span style="color:#E1E4E8;">() </span><span style="color:#F97583;">+</span><span style="color:#E1E4E8;"> System.</span><span style="color:#B392F0;">currentTimeMillis</span><span style="color:#E1E4E8;">();</span></span>
<span class="line"><span style="color:#E1E4E8;">        } </span><span style="color:#F97583;">catch</span><span style="color:#E1E4E8;"> (Exception </span><span style="color:#FFAB70;">e</span><span style="color:#E1E4E8;">) {</span></span>
<span class="line"><span style="color:#E1E4E8;">            </span><span style="color:#F97583;">throw</span><span style="color:#E1E4E8;"> </span><span style="color:#F97583;">new</span><span style="color:#E1E4E8;"> </span><span style="color:#B392F0;">SchedulerException</span><span style="color:#E1E4E8;">(</span><span style="color:#9ECBFF;">&quot;Couldn&#39;t get host name!&quot;</span><span style="color:#E1E4E8;">, e);</span></span>
<span class="line"><span style="color:#E1E4E8;">        }</span></span>
<span class="line"><span style="color:#E1E4E8;">    }</span></span>
<span class="line"><span style="color:#E1E4E8;">}</span></span></code></pre><pre class="shiki github-light vp-code-light"><code><span class="line"><span style="color:#D73A49;">public</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">class</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SimpleInstanceIdGenerator</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">implements</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">InstanceIdGenerator</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">    </span><span style="color:#D73A49;">public</span><span style="color:#24292E;"> String </span><span style="color:#6F42C1;">generateInstanceId</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">throws</span><span style="color:#24292E;"> SchedulerException {</span></span>
<span class="line"><span style="color:#24292E;">        </span><span style="color:#D73A49;">try</span><span style="color:#24292E;"> {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">return</span><span style="color:#24292E;"> InetAddress.</span><span style="color:#6F42C1;">getLocalHost</span><span style="color:#24292E;">().</span><span style="color:#6F42C1;">getHostName</span><span style="color:#24292E;">() </span><span style="color:#D73A49;">+</span><span style="color:#24292E;"> System.</span><span style="color:#6F42C1;">currentTimeMillis</span><span style="color:#24292E;">();</span></span>
<span class="line"><span style="color:#24292E;">        } </span><span style="color:#D73A49;">catch</span><span style="color:#24292E;"> (Exception </span><span style="color:#E36209;">e</span><span style="color:#24292E;">) {</span></span>
<span class="line"><span style="color:#24292E;">            </span><span style="color:#D73A49;">throw</span><span style="color:#24292E;"> </span><span style="color:#D73A49;">new</span><span style="color:#24292E;"> </span><span style="color:#6F42C1;">SchedulerException</span><span style="color:#24292E;">(</span><span style="color:#032F62;">&quot;Couldn&#39;t get host name!&quot;</span><span style="color:#24292E;">, e);</span></span>
<span class="line"><span style="color:#24292E;">        }</span></span>
<span class="line"><span style="color:#24292E;">    }</span></span>
<span class="line"><span style="color:#24292E;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>处理方法:</p><p>进入线上环境(centOs6.x):</p><p>1, 查看主机名(命令) : hostname</p><p>2, 打开 hosts 文件: <code>vi /etc/hosts</code> 查看是否有乱码等异常内容</p><p>3, 确保有: 127.0.0.1 后跟上面用 hostname 命令查看到的主机名， 如果没有则加上</p><p>如 : hostname -&gt; USER-1234</p><p>则: 127.0.0.1 USER-1234</p><p>程序正常， 定时任务正常</p>`,99),e=[o];function c(r,t,y,E,i,F){return a(),n("div",null,e)}const u=s(p,[["render",c]]);export{b as __pageData,u as default};
